var t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;import{d as i,V as a,s as o}from"./vendor.e9c367ae.js";import{H as n,m as r}from"./HTTPFileSystem.e57ad358.js";import{n as l,p as c,g as d,S as u,f as h,a as m}from"./index.2deacc07.js";import{m as f}from"./index.d3193298.js";import{b as p}from"./index.3d2ad359.js";import{D as g}from"./DashBoard.61a0fedf.js";import{T as v}from"./TopSheet.2244b18e.js";import{D as y}from"./DashboardDataManager.e0d06cdd.js";import"./util.b5d45f97.js";import"./RoadNetworkLoader.worker.30fe4a65.js";import"./index.5877f313.js";
/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function C(t,e,s){return(C=w()?Reflect.construct:function(t,e,s){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return s&&S(a,s.prototype),a}).apply(null,arguments)}function _(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return k(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var T=Object.hasOwnProperty,E=Object.setPrototypeOf,x=Object.isFrozen,D=Object.getPrototypeOf,L=Object.getOwnPropertyDescriptor,z=Object.freeze,F=Object.seal,A=Object.create,O="undefined"!=typeof Reflect&&Reflect,R=O.apply,N=O.construct;R||(R=function(t,e,s){return t.apply(e,s)}),z||(z=function(t){return t}),F||(F=function(t){return t}),N||(N=function(t,e){return C(t,_(e))});var P,$=G(Array.prototype.forEach),j=G(Array.prototype.pop),M=G(Array.prototype.push),I=G(String.prototype.toLowerCase),H=G(String.prototype.match),W=G(String.prototype.replace),B=G(String.prototype.indexOf),U=G(String.prototype.trim),q=G(RegExp.prototype.test),V=(P=TypeError,function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return N(P,e)});function G(t){return function(e){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return R(t,e,i)}}function Y(t,e,s){s=s||I,E&&E(t,null);for(var i=e.length;i--;){var a=e[i];if("string"==typeof a){var o=s(a);o!==a&&(x(e)||(e[i]=o),a=o)}t[a]=!0}return t}function Z(t){var e,s=A(null);for(e in t)R(T,t,[e])&&(s[e]=t[e]);return s}function J(t,e){for(;null!==t;){var s=L(t,e);if(s){if(s.get)return G(s.get);if("function"==typeof s.value)return G(s.value)}t=D(t)}return function(t){return console.warn("fallback value for",t),null}}var X=z(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),K=z(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Q=z(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tt=z(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),et=z(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),st=z(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),it=z(["#text"]),at=z(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ot=z(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nt=z(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rt=z(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),lt=F(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ct=F(/<%[\w\W]*|[\w\W]*%>/gm),dt=F(/^data-[\-\w.\u00B7-\uFFFF]/),ut=F(/^aria-[\-\w]+$/),ht=F(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mt=F(/^(?:\w+script|data):/i),ft=F(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pt=F(/^html$/i),gt=function(){return"undefined"==typeof window?null:window},vt=function(t,e){if("object"!==b(t)||"function"!=typeof t.createPolicy)return null;var s=null,i="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(i)&&(s=e.currentScript.getAttribute(i));var a="dompurify"+(s?"#"+s:"");try{return t.createPolicy(a,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(o){return console.warn("TrustedTypes policy "+a+" could not be created."),null}};var yt=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt(),s=function(e){return t(e)};if(s.version="2.4.0",s.removed=[],!e||!e.document||9!==e.document.nodeType)return s.isSupported=!1,s;var i=e.document,a=e.document,o=e.DocumentFragment,n=e.HTMLTemplateElement,r=e.Node,l=e.Element,c=e.NodeFilter,d=e.NamedNodeMap,u=void 0===d?e.NamedNodeMap||e.MozNamedAttrMap:d,h=e.HTMLFormElement,m=e.DOMParser,f=e.trustedTypes,p=l.prototype,g=J(p,"cloneNode"),v=J(p,"nextSibling"),y=J(p,"childNodes"),S=J(p,"parentNode");if("function"==typeof n){var w=a.createElement("template");w.content&&w.content.ownerDocument&&(a=w.content.ownerDocument)}var C=vt(f,i),k=C?C.createHTML(""):"",T=a,E=T.implementation,x=T.createNodeIterator,D=T.createDocumentFragment,L=T.getElementsByTagName,F=i.importNode,A={};try{A=Z(a).documentMode?a.documentMode:{}}catch(xe){}var O={};s.isSupported="function"==typeof S&&E&&void 0!==E.createHTMLDocument&&9!==A;var R,N,P=lt,G=ct,yt=dt,bt=ut,St=mt,wt=ft,Ct=ht,_t=null,kt=Y({},[].concat(_(X),_(K),_(Q),_(et),_(it))),Tt=null,Et=Y({},[].concat(_(at),_(ot),_(nt),_(rt))),xt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Dt=null,Lt=null,zt=!0,Ft=!0,At=!1,Ot=!1,Rt=!1,Nt=!1,Pt=!1,$t=!1,jt=!1,Mt=!1,It=!0,Ht=!1,Wt="user-content-",Bt=!0,Ut=!1,qt={},Vt=null,Gt=Y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Yt=null,Zt=Y({},["audio","video","img","source","image","track"]),Jt=null,Xt=Y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Kt="http://www.w3.org/1998/Math/MathML",Qt="http://www.w3.org/2000/svg",te="http://www.w3.org/1999/xhtml",ee=te,se=!1,ie=["application/xhtml+xml","text/html"],ae="text/html",oe=null,ne=a.createElement("form"),re=function(t){return t instanceof RegExp||t instanceof Function},le=function(t){oe&&oe===t||(t&&"object"===b(t)||(t={}),t=Z(t),R=R=-1===ie.indexOf(t.PARSER_MEDIA_TYPE)?ae:t.PARSER_MEDIA_TYPE,N="application/xhtml+xml"===R?function(t){return t}:I,_t="ALLOWED_TAGS"in t?Y({},t.ALLOWED_TAGS,N):kt,Tt="ALLOWED_ATTR"in t?Y({},t.ALLOWED_ATTR,N):Et,Jt="ADD_URI_SAFE_ATTR"in t?Y(Z(Xt),t.ADD_URI_SAFE_ATTR,N):Xt,Yt="ADD_DATA_URI_TAGS"in t?Y(Z(Zt),t.ADD_DATA_URI_TAGS,N):Zt,Vt="FORBID_CONTENTS"in t?Y({},t.FORBID_CONTENTS,N):Gt,Dt="FORBID_TAGS"in t?Y({},t.FORBID_TAGS,N):{},Lt="FORBID_ATTR"in t?Y({},t.FORBID_ATTR,N):{},qt="USE_PROFILES"in t&&t.USE_PROFILES,zt=!1!==t.ALLOW_ARIA_ATTR,Ft=!1!==t.ALLOW_DATA_ATTR,At=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ot=t.SAFE_FOR_TEMPLATES||!1,Rt=t.WHOLE_DOCUMENT||!1,$t=t.RETURN_DOM||!1,jt=t.RETURN_DOM_FRAGMENT||!1,Mt=t.RETURN_TRUSTED_TYPE||!1,Pt=t.FORCE_BODY||!1,It=!1!==t.SANITIZE_DOM,Ht=t.SANITIZE_NAMED_PROPS||!1,Bt=!1!==t.KEEP_CONTENT,Ut=t.IN_PLACE||!1,Ct=t.ALLOWED_URI_REGEXP||Ct,ee=t.NAMESPACE||te,t.CUSTOM_ELEMENT_HANDLING&&re(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xt.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&re(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xt.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xt.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ot&&(Ft=!1),jt&&($t=!0),qt&&(_t=Y({},_(it)),Tt=[],!0===qt.html&&(Y(_t,X),Y(Tt,at)),!0===qt.svg&&(Y(_t,K),Y(Tt,ot),Y(Tt,rt)),!0===qt.svgFilters&&(Y(_t,Q),Y(Tt,ot),Y(Tt,rt)),!0===qt.mathMl&&(Y(_t,et),Y(Tt,nt),Y(Tt,rt))),t.ADD_TAGS&&(_t===kt&&(_t=Z(_t)),Y(_t,t.ADD_TAGS,N)),t.ADD_ATTR&&(Tt===Et&&(Tt=Z(Tt)),Y(Tt,t.ADD_ATTR,N)),t.ADD_URI_SAFE_ATTR&&Y(Jt,t.ADD_URI_SAFE_ATTR,N),t.FORBID_CONTENTS&&(Vt===Gt&&(Vt=Z(Vt)),Y(Vt,t.FORBID_CONTENTS,N)),Bt&&(_t["#text"]=!0),Rt&&Y(_t,["html","head","body"]),_t.table&&(Y(_t,["tbody"]),delete Dt.tbody),z&&z(t),oe=t)},ce=Y({},["mi","mo","mn","ms","mtext"]),de=Y({},["foreignobject","desc","title","annotation-xml"]),ue=Y({},["title","style","font","a","script"]),he=Y({},K);Y(he,Q),Y(he,tt);var me=Y({},et);Y(me,st);var fe=function(t){var e=S(t);e&&e.tagName||(e={namespaceURI:te,tagName:"template"});var s=I(t.tagName),i=I(e.tagName);return t.namespaceURI===Qt?e.namespaceURI===te?"svg"===s:e.namespaceURI===Kt?"svg"===s&&("annotation-xml"===i||ce[i]):Boolean(he[s]):t.namespaceURI===Kt?e.namespaceURI===te?"math"===s:e.namespaceURI===Qt?"math"===s&&de[i]:Boolean(me[s]):t.namespaceURI===te&&(!(e.namespaceURI===Qt&&!de[i])&&(!(e.namespaceURI===Kt&&!ce[i])&&(!me[s]&&(ue[s]||!he[s]))))},pe=function(t){M(s.removed,{element:t});try{t.parentNode.removeChild(t)}catch(xe){try{t.outerHTML=k}catch(e){t.remove()}}},ge=function(t,e){try{M(s.removed,{attribute:e.getAttributeNode(t),from:e})}catch(xe){M(s.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Tt[t])if($t||jt)try{pe(e)}catch(xe){}else try{e.setAttribute(t,"")}catch(xe){}},ve=function(t){var e,s;if(Pt)t="<remove></remove>"+t;else{var i=H(t,/^[\r\n\t ]+/);s=i&&i[0]}"application/xhtml+xml"===R&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=C?C.createHTML(t):t;if(ee===te)try{e=(new m).parseFromString(o,R)}catch(xe){}if(!e||!e.documentElement){e=E.createDocument(ee,"template",null);try{e.documentElement.innerHTML=se?"":o}catch(xe){}}var n=e.body||e.documentElement;return t&&s&&n.insertBefore(a.createTextNode(s),n.childNodes[0]||null),ee===te?L.call(e,Rt?"html":"body")[0]:Rt?e.documentElement:n},ye=function(t){return x.call(t.ownerDocument||t,t,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},be=function(t){return t instanceof h&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof u)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)},Se=function(t){return"object"===b(r)?t instanceof r:t&&"object"===b(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},we=function(t,e,i){O[t]&&$(O[t],(function(t){t.call(s,e,i,oe)}))},Ce=function(t){var e;if(we("beforeSanitizeElements",t,null),be(t))return pe(t),!0;if(q(/[\u0080-\uFFFF]/,t.nodeName))return pe(t),!0;var i=N(t.nodeName);if(we("uponSanitizeElement",t,{tagName:i,allowedTags:_t}),t.hasChildNodes()&&!Se(t.firstElementChild)&&(!Se(t.content)||!Se(t.content.firstElementChild))&&q(/<[/\w]/g,t.innerHTML)&&q(/<[/\w]/g,t.textContent))return pe(t),!0;if("select"===i&&q(/<template/i,t.innerHTML))return pe(t),!0;if(!_t[i]||Dt[i]){if(!Dt[i]&&ke(i)){if(xt.tagNameCheck instanceof RegExp&&q(xt.tagNameCheck,i))return!1;if(xt.tagNameCheck instanceof Function&&xt.tagNameCheck(i))return!1}if(Bt&&!Vt[i]){var a=S(t)||t.parentNode,o=y(t)||t.childNodes;if(o&&a)for(var n=o.length-1;n>=0;--n)a.insertBefore(g(o[n],!0),v(t))}return pe(t),!0}return t instanceof l&&!fe(t)?(pe(t),!0):"noscript"!==i&&"noembed"!==i||!q(/<\/no(script|embed)/i,t.innerHTML)?(Ot&&3===t.nodeType&&(e=t.textContent,e=W(e,P," "),e=W(e,G," "),t.textContent!==e&&(M(s.removed,{element:t.cloneNode()}),t.textContent=e)),we("afterSanitizeElements",t,null),!1):(pe(t),!0)},_e=function(t,e,s){if(It&&("id"===e||"name"===e)&&(s in a||s in ne))return!1;if(Ft&&!Lt[e]&&q(yt,e));else if(zt&&q(bt,e));else if(!Tt[e]||Lt[e]){if(!(ke(t)&&(xt.tagNameCheck instanceof RegExp&&q(xt.tagNameCheck,t)||xt.tagNameCheck instanceof Function&&xt.tagNameCheck(t))&&(xt.attributeNameCheck instanceof RegExp&&q(xt.attributeNameCheck,e)||xt.attributeNameCheck instanceof Function&&xt.attributeNameCheck(e))||"is"===e&&xt.allowCustomizedBuiltInElements&&(xt.tagNameCheck instanceof RegExp&&q(xt.tagNameCheck,s)||xt.tagNameCheck instanceof Function&&xt.tagNameCheck(s))))return!1}else if(Jt[e]);else if(q(Ct,W(s,wt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==B(s,"data:")||!Yt[t]){if(At&&!q(St,W(s,wt,"")));else if(s)return!1}else;return!0},ke=function(t){return t.indexOf("-")>0},Te=function(t){var e,i,a,o;we("beforeSanitizeAttributes",t,null);var n=t.attributes;if(n){var r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Tt};for(o=n.length;o--;){var l=e=n[o],c=l.name,d=l.namespaceURI;if(i="value"===c?e.value:U(e.value),a=N(c),r.attrName=a,r.attrValue=i,r.keepAttr=!0,r.forceKeepAttr=void 0,we("uponSanitizeAttribute",t,r),i=r.attrValue,!r.forceKeepAttr&&(ge(c,t),r.keepAttr))if(q(/\/>/i,i))ge(c,t);else{Ot&&(i=W(i,P," "),i=W(i,G," "));var u=N(t.nodeName);if(_e(u,a,i)){if(!Ht||"id"!==a&&"name"!==a||(ge(c,t),i=Wt+i),C&&"object"===b(f)&&"function"==typeof f.getAttributeType)if(d);else switch(f.getAttributeType(u,a)){case"TrustedHTML":i=C.createHTML(i);break;case"TrustedScriptURL":i=C.createScriptURL(i)}try{d?t.setAttributeNS(d,c,i):t.setAttribute(c,i),j(s.removed)}catch(xe){}}}}we("afterSanitizeAttributes",t,null)}},Ee=function t(e){var s,i=ye(e);for(we("beforeSanitizeShadowDOM",e,null);s=i.nextNode();)we("uponSanitizeShadowNode",s,null),Ce(s)||(s.content instanceof o&&t(s.content),Te(s));we("afterSanitizeShadowDOM",e,null)};return s.sanitize=function(t){var a,n,l,c,d,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((se=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Se(t)){if("function"!=typeof t.toString)throw V("toString is not a function");if("string"!=typeof(t=t.toString()))throw V("dirty is not a string, aborting")}if(!s.isSupported){if("object"===b(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof t)return e.toStaticHTML(t);if(Se(t))return e.toStaticHTML(t.outerHTML)}return t}if(Nt||le(u),s.removed=[],"string"==typeof t&&(Ut=!1),Ut){if(t.nodeName){var h=N(t.nodeName);if(!_t[h]||Dt[h])throw V("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof r)1===(n=(a=ve("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?a=n:a.appendChild(n);else{if(!$t&&!Ot&&!Rt&&-1===t.indexOf("<"))return C&&Mt?C.createHTML(t):t;if(!(a=ve(t)))return $t?null:Mt?k:""}a&&Pt&&pe(a.firstChild);for(var m=ye(Ut?t:a);l=m.nextNode();)3===l.nodeType&&l===c||Ce(l)||(l.content instanceof o&&Ee(l.content),Te(l),c=l);if(c=null,Ut)return t;if($t){if(jt)for(d=D.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return Tt.shadowroot&&(d=F.call(i,d,!0)),d}var f=Rt?a.outerHTML:a.innerHTML;return Rt&&_t["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&q(pt,a.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+f),Ot&&(f=W(f,P," "),f=W(f,G," ")),C&&Mt?C.createHTML(f):f},s.setConfig=function(t){le(t),Nt=!0},s.clearConfig=function(){oe=null,Nt=!1},s.isValidAttribute=function(t,e,s){oe||le({});var i=N(t),a=N(e);return _e(i,a,s)},s.addHook=function(t,e){"function"==typeof e&&(O[t]=O[t]||[],M(O[t],e))},s.removeHook=function(t){if(O[t])return j(O[t])},s.removeHooks=function(t){O[t]&&(O[t]=[])},s.removeAllHooks=function(){O={}},s}(),bt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},St=function(t){return"IMG"===t.tagName},wt=function(t){return t&&1===t.nodeType},Ct=function(t){return".svg"===(t.currentSrc||t.src).substr(-4).toLowerCase()},_t=function(t){try{return Array.isArray(t)?t.filter(St):function(t){return NodeList.prototype.isPrototypeOf(t)}(t)?[].slice.call(t).filter(St):wt(t)?[t].filter(St):"string"==typeof t?[].slice.call(document.querySelectorAll(t)).filter(St):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},kt=function(t){var e=document.createElement("div");return e.classList.add("medium-zoom-overlay"),e.style.background=t,e},Tt=function(t){var e=t.getBoundingClientRect(),s=e.top,i=e.left,a=e.width,o=e.height,n=t.cloneNode(),r=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return n.removeAttribute("id"),n.style.position="absolute",n.style.top=s+r+"px",n.style.left=i+l+"px",n.style.width=a+"px",n.style.height=o+"px",n.style.transform="",n},Et=function(t,e){var s=bt({bubbles:!1,cancelable:!1,detail:void 0},e);if("function"==typeof window.CustomEvent)return new CustomEvent(t,s);var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,s.bubbles,s.cancelable,s.detail),i};
/*! medium-zoom 1.0.6 | MIT License | https://github.com/francoischalifour/medium-zoom */!function(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===s&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}");var xt=function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=window.Promise||function(t){function e(){}t(e,e)},a=function(t){var e=t.target;e!==T?-1!==b.indexOf(e)&&p({target:e}):f()},o=function(){if(!w&&k.original){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(C-t)>_.scrollOffset&&setTimeout(f,150)}},n=function(t){var e=t.key||t.keyCode;"Escape"!==e&&"Esc"!==e&&27!==e||f()},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t;if(t.background&&(T.style.background=t.background),t.container&&t.container instanceof Object&&(e.container=bt({},_.container,t.container)),t.template){var s=wt(t.template)?t.template:document.querySelector(t.template);e.template=s}return _=bt({},_,e),b.forEach((function(t){t.dispatchEvent(Et("medium-zoom:update",{detail:{zoom:E}}))})),E},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(bt({},_,e))},c=function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];var i=e.reduce((function(t,e){return[].concat(t,_t(e))}),[]);return i.filter((function(t){return-1===b.indexOf(t)})).forEach((function(t){b.push(t),t.classList.add("medium-zoom-image")})),S.forEach((function(t){var e=t.type,s=t.listener,a=t.options;i.forEach((function(t){t.addEventListener(e,s,a)}))})),E},d=function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];k.zoomed&&f();var i=e.length>0?e.reduce((function(t,e){return[].concat(t,_t(e))}),[]):b;return i.forEach((function(t){t.classList.remove("medium-zoom-image"),t.dispatchEvent(Et("medium-zoom:detach",{detail:{zoom:E}}))})),b=b.filter((function(t){return-1===i.indexOf(t)})),E},u=function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return b.forEach((function(i){i.addEventListener("medium-zoom:"+t,e,s)})),S.push({type:"medium-zoom:"+t,listener:e,options:s}),E},h=function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return b.forEach((function(i){i.removeEventListener("medium-zoom:"+t,e,s)})),S=S.filter((function(s){return!(s.type==="medium-zoom:"+t&&s.listener.toString()===e.toString())})),E},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,s=function(){var t={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},e=void 0,s=void 0;if(_.container)if(_.container instanceof Object)e=(t=bt({},t,_.container)).width-t.left-t.right-2*_.margin,s=t.height-t.top-t.bottom-2*_.margin;else{var i=(wt(_.container)?_.container:document.querySelector(_.container)).getBoundingClientRect(),a=i.width,o=i.height,n=i.left,r=i.top;t=bt({},t,{width:a,height:o,left:n,top:r})}e=e||t.width-2*_.margin,s=s||t.height-2*_.margin;var l=k.zoomedHd||k.original,c=Ct(l)?e:l.naturalWidth||e,d=Ct(l)?s:l.naturalHeight||s,u=l.getBoundingClientRect(),h=u.top,m=u.left,f=u.width,p=u.height,g=Math.min(c,e)/f,v=Math.min(d,s)/p,y=Math.min(g,v),b="scale("+y+") translate3d("+((e-f)/2-m+_.margin+t.left)/y+"px, "+((s-p)/2-h+_.margin+t.top)/y+"px, 0)";k.zoomed.style.transform=b,k.zoomedHd&&(k.zoomedHd.style.transform=b)};return new i((function(t){if(e&&-1===b.indexOf(e))t(E);else{if(k.zoomed)t(E);else{if(e)k.original=e;else{if(!(b.length>0))return void t(E);var i=b;k.original=i[0]}if(k.original.dispatchEvent(Et("medium-zoom:open",{detail:{zoom:E}})),C=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,w=!0,k.zoomed=Tt(k.original),document.body.appendChild(T),_.template){var a=wt(_.template)?_.template:document.querySelector(_.template);k.template=document.createElement("div"),k.template.appendChild(a.content.cloneNode(!0)),document.body.appendChild(k.template)}if(document.body.appendChild(k.zoomed),window.requestAnimationFrame((function(){document.body.classList.add("medium-zoom--opened")})),k.original.classList.add("medium-zoom-image--hidden"),k.zoomed.classList.add("medium-zoom-image--opened"),k.zoomed.addEventListener("click",f),k.zoomed.addEventListener("transitionend",(function e(){w=!1,k.zoomed.removeEventListener("transitionend",e),k.original.dispatchEvent(Et("medium-zoom:opened",{detail:{zoom:E}})),t(E)})),k.original.getAttribute("data-zoom-src")){k.zoomedHd=k.zoomed.cloneNode(),k.zoomedHd.removeAttribute("srcset"),k.zoomedHd.removeAttribute("sizes"),k.zoomedHd.src=k.zoomed.getAttribute("data-zoom-src"),k.zoomedHd.onerror=function(){clearInterval(o),console.warn("Unable to reach the zoom image target "+k.zoomedHd.src),k.zoomedHd=null,s()};var o=setInterval((function(){k.zoomedHd.complete&&(clearInterval(o),k.zoomedHd.classList.add("medium-zoom-image--opened"),k.zoomedHd.addEventListener("click",f),document.body.appendChild(k.zoomedHd),s())}),10)}else if(k.original.hasAttribute("srcset")){k.zoomedHd=k.zoomed.cloneNode(),k.zoomedHd.removeAttribute("sizes"),k.zoomedHd.removeAttribute("loading");var n=k.zoomedHd.addEventListener("load",(function(){k.zoomedHd.removeEventListener("load",n),k.zoomedHd.classList.add("medium-zoom-image--opened"),k.zoomedHd.addEventListener("click",f),document.body.appendChild(k.zoomedHd),s()}))}else s()}}}))},f=function(){return new i((function(t){if(!w&&k.original){w=!0,document.body.classList.remove("medium-zoom--opened"),k.zoomed.style.transform="",k.zoomedHd&&(k.zoomedHd.style.transform=""),k.template&&(k.template.style.transition="opacity 150ms",k.template.style.opacity=0),k.original.dispatchEvent(Et("medium-zoom:close",{detail:{zoom:E}})),k.zoomed.addEventListener("transitionend",(function e(){k.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(k.zoomed),k.zoomedHd&&document.body.removeChild(k.zoomedHd),document.body.removeChild(T),k.zoomed.classList.remove("medium-zoom-image--opened"),k.template&&document.body.removeChild(k.template),w=!1,k.zoomed.removeEventListener("transitionend",e),k.original.dispatchEvent(Et("medium-zoom:closed",{detail:{zoom:E}})),k.original=null,k.zoomed=null,k.zoomedHd=null,k.template=null,t(E)}))}else t(E)}))},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target;return k.original?f():m({target:e})},g=function(){return _},v=function(){return b},y=function(){return k.original},b=[],S=[],w=!1,C=0,_=s,k={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(e)?_=e:(e||"string"==typeof e)&&c(e),_=bt({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},_);var T=kt(_.background);document.addEventListener("click",a),document.addEventListener("keyup",n),document.addEventListener("scroll",o),window.addEventListener("resize",f);var E={open:m,close:f,toggle:p,update:r,clone:l,attach:c,detach:d,on:u,off:h,getOptions:g,getImages:v,getZoomedImage:y};return E};var Dt=i({name:"TopsheetsFinder",i18n:{messages:{en:{title:"Key Performance Indicators"}}},components:{TopSheet:v},props:{fileSystemConfig:{type:Object,required:!0},subfolder:{type:String,required:!0},files:{type:Array,required:!0}},computed:{fileApi(){return new n(this.fileSystemConfig)}},data:()=>({allConfigFiles:{},topsheets:[]}),watch:{subfolder(){this.filesUpdated()},files(){this.filesUpdated()}},methods:{async findTopsheetsForThisFolder(){return this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.subfolder),Object.values(this.allConfigFiles.topsheets)},async filesUpdated(){this.files.length&&(this.topsheets=await this.findTopsheetsForThisFolder())}}});const Lt={};var zt=l(Dt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topsheets-finder curate-content"},t._l(t.topsheets,(function(e){return s("top-sheet",{key:e,attrs:{fileSystemConfig:t.fileSystemConfig,subfolder:t.subfolder,files:t.files,yaml:e,allConfigFiles:t.allConfigFiles}})})),1)}),[],!1,Ft,"13752aaf",null,null);function Ft(t){for(let e in Lt)this[e]=Lt[e]}var At=function(){return zt.exports}();const Ot={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270","carrier-viewer":"#c97A2C",events:"#4400ff",hexagons:"#900564","area-map":"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"};var Rt=i({name:"FolderBrowser",i18n:{messages:{en:{Maps:"Maps",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Topsheet"},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Topsheet"}}},components:Object.assign({TopsheetsFinder:At},c),props:{root:{type:String,required:!0},allConfigFiles:{type:Object,required:!0},xsubfolder:String},data:()=>({globalState:d.state,summaryYamlFilename:"viz-summary.yml",mdRenderer:new f({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1}}),computed:{vizImages(){const t={};for(let e=0;e<this.myState.vizes.length;e++)"image-view"===this.myState.vizes[e].component&&(t[e]=this.myState.vizes[e]);return t},vizMaps(){const t={};for(let e=0;e<this.myState.vizes.length;e++)"image-view"!==this.myState.vizes[e].component&&(t[e]=this.myState.vizes[e]);return t}},methods:{cleanName:t=>decodeURIComponent(t),getFileSystem(t){const e=d.state.svnProjects.filter((e=>e.slug===t));if(0===e.length)throw console.log("no such project"),Error;return e[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const t=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],e=this.myState.subfolder.split("/");let s="/";for(const i of e)i&&(s+=i+"/",t.push({label:i,url:"/"+this.myState.svnProject.slug+s}));return d.commit("setBreadCrumbs",t),t},clickedVisualization(t){const e=this.myState.vizes[t];if("image-view"===e.component)return;if(!this.myState.svnProject)return;const s={root:this.myState.svnProject.slug,xsubfolder:this.myState.subfolder,subfolder:this.myState.subfolder,yamlConfig:e.config,thumbnail:!1};this.$emit("navigate",{component:e.component,props:s})},updateTitle(t,e){this.myState.vizes[t].title=e},async showReadme(){this.myState.readme="";const t="readme.md";if(this.myState.files.map((t=>t.toLocaleLowerCase())).indexOf(t)>-1){if(!this.myState.svnRoot)return;const e=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+t);this.myState.readme=this.mdRenderer.render(e)}},buildShowEverythingView(){for(const t of this.globalState.visualizationTypes.values()){const e=r(this.myState.files,t.filePatterns,{nocase:!0});for(const s of e)this.myState.vizes.push({component:t.kebabName,config:s,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const t=p.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const e of t.plugins){const s=this.globalState.visualizationTypes.get(e);if(s)if(t[s.kebabName])for(const e of t[s.kebabName]){const t=await this.findMatchingFiles(e);for(const e of t)this.myState.vizes.push({component:s.kebabName,config:e,title:e})}else{const t=r(this.myState.files,s.filePatterns);for(const e of t)this.myState.vizes.push({component:s.kebabName,config:e,title:".."})}}},async findMatchingFiles(t){if(this.myState.files.indexOf(t)>-1)return[t];const e=r(this.myState.files,t);if(e.length)return e;if(!this.myState.svnRoot)return[];try{const e=t.split("/"),s=this.myState.subfolder+"/"+e[0];console.log(s);const i=await this.myState.svnRoot.getDirectory(s);return r(i.files,e[1]).map((t=>e[0]+"/"+t))}catch(s){}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{const t=await this.myState.svnRoot.getDirectory(this.myState.subfolder),e=t.dirs.filter((t=>!t.startsWith("."))).sort(),s=t.files.filter((t=>!t.startsWith("."))).sort(),i=Object.assign({},this.allConfigFiles.vizes);for(const o of s)i[o]=o;const a=Object.values(i);this.myState.errorStatus="",this.myState.folders=e,this.myState.files=a}catch(t){const e=t;console.log("BAD PAGE"),console.log({eeee:e}),this.myState.folders=[],this.myState.files=[],this.myState.errorStatus="<h3>",e.status&&(this.myState.errorStatus+=`${e.status} `),e.statusText&&(this.myState.errorStatus+=`${e.statusText}`),"<h3>"===this.myState.errorStatus&&(this.myState.errorStatus+="Error"),this.myState.errorStatus+="</h3>",e.url&&(this.myState.errorStatus+=`<p>${e.url}</p>`),e.message&&(this.myState.errorStatus+=`<p>${e.message}</p>`),"<h3>Error</h3>"===this.myState.errorStatus&&(this.myState.errorStatus=""+e),this.myState.svnProject&&(this.myState.errorStatus+=`<p><i>${this.myState.svnProject.baseURL}${this.myState.subfolder}</i></p>`),this.myState.svnProject&&this.myState.svnProject.needPassword&&401===e.status&&d.commit("requestLogin",this.myState.svnProject.slug)}finally{this.myState.isLoading=!1}},openOutputFolder(t){if(this.myState.isLoading)return;if(!this.myState.svnProject)return;const e=".."===t?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+t,s={root:this.myState.svnProject.slug,xsubfolder:e};e||this.myState.subfolder?this.$emit("navigate",{component:"TabbedDashboardView",props:s}):this.$emit("navigate",{component:"SplashPage",props:{}})},getTabColor:t=>({backgroundColor:Ot[t]||"#8778BB"}),updateRoute(){const t=this.getFileSystem(this.root);this.myState.svnProject=t,this.myState.subfolder=this.xsubfolder||"",this.myState.readme="",this.myState.svnProject&&(this.myState.svnRoot=new n(this.myState.svnProject),this.generateBreadcrumbs(),this.fetchFolderContents())}},watch:{"globalState.colorScheme"(){this.fetchFolderContents()},xsubfolder(){this.updateRoute()},allConfigFiles(){this.updateRoute()},"globalState.authAttempts"(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async"myState.files"(){this.myState.vizes=[],0!==this.myState.files.length&&(this.showReadme(),this.myState.summary=-1!==this.myState.files.indexOf(this.summaryYamlFilename),this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),xt(".medium-zoom",{background:"#444450"}))}},mounted(){this.updateRoute()}});const Nt={};var Pt=l(Rt,(function(){var t,e,s=this,i=s.$createElement,a=s._self._c||i;return a("div",{staticClass:"folder-browser"},[s.myState.errorStatus?a("div",{staticClass:"stripe details"},[a("div",{staticClass:"vessel"},[a("div",{staticClass:"badnews",domProps:{innerHTML:s._s(s.myState.errorStatus)}})])]):a("div",{staticClass:"stripe details"},[a("div",{staticClass:"vessel"},[a("div",{staticClass:"curated-sections"},[a("b",{staticClass:"up-link"},[a("a",{on:{click:function(t){return s.$emit("up")}}},[s._v("^ UP")])]),a("div",{staticClass:"readme-header markdown"},[s.myState.readme?a("div",{staticClass:"curate-content markdown",domProps:{innerHTML:s._s(s.myState.readme)}}):s._e()]),s.myState.folders.length?a("h3",{staticClass:"curate-heading"},[s._v(" "+s._s(s.$t("Folders")))]):s._e(),s.myState.folders.length?a("div",{staticClass:"curate-content"},[a("div",{staticClass:"folder-table"},s._l(s.myState.folders,(function(t){return a("div",{key:t.name,staticClass:"folder",class:{fade:s.myState.isLoading},on:{click:function(e){return s.openOutputFolder(t)}}},[a("p",[a("i",{staticClass:"fa fa-folder-open"}),s._v("Â "+s._s(s.cleanName(t)))])])})),0)]):s._e(),Object.keys(s.vizMaps).length?a("div",{staticClass:"section-maps"},[a("h3",{staticClass:"curate-heading"},[s._v(s._s(s.$t("Maps")))]),a("div",{staticClass:"curate-content"},[a("div",{staticClass:"viz-table"},s._l(Object.entries(s.vizMaps),(function(t){var e=t[0],i=t[1];return a("div",{key:e,staticClass:"viz-grid-item",on:{click:function(t){return s.clickedVisualization(e)}}},[a("div",{staticClass:"viz-frame"},[a("p",{staticClass:"v-title"},[a("b",[s._v(s._s(i.title))])]),a("p",{staticClass:"v-filename"},[s._v(s._s(i.config))]),a("p",{staticClass:"v-plugin",style:s.getTabColor(i.component)},[s._v(s._s(i.component||"dashboard"))]),a(i.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:s.myState.svnProject.slug,subfolder:s.myState.subfolder,yamlConfig:i.config,thumbnail:!0,fileApi:s.myState.svnRoot},on:{title:function(t){return s.updateTitle(e,t)}}})],1)])})),0)])]):s._e(),Object.keys(s.vizImages).length?a("div",{staticClass:"section-images"},[a("h3",{staticClass:"curate-heading"},[s._v(s._s(s.$t("Images")))]),a("div",{staticClass:"curate-content"},[a("div",{staticClass:"viz-image-table"},s._l(Object.entries(s.vizImages),(function(t){var e=t[0],i=t[1];return a("div",{key:e,staticClass:"viz-image-grid-item",on:{click:function(t){return s.clickedVisualization(e)}}},[a("div",{staticClass:"viz-image-frame"},[a(i.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:s.myState.svnProject.slug,subfolder:s.myState.subfolder,yamlConfig:i.config,thumbnail:!0,fileApi:s.myState.svnRoot},on:{title:function(t){return s.updateTitle(e,t)}}}),a("p",[s._v(s._s(i.title))])],1)])})),0)])]):s._e(),null!==(t=s.myState)&&void 0!==t&&null!==(e=t.svnProject)&&void 0!==e&&e.baseURL?a("div",{staticClass:"files-section"},[s.myState.files.length?a("h3",{staticClass:"curate-heading"},[s._v(s._s(s.$t("Files")))]):s._e(),s.myState.files.length?a("div",{staticClass:"curate-content"},[a("div",{staticClass:"file-table"},s._l(s.myState.files,(function(t){return a("div",{key:t,staticClass:"file",class:{fade:s.myState.isLoading}},[a("a",{attrs:{href:`${s.myState.svnProject.baseURL}/${s.myState.subfolder}/${t}`}},[s._v(s._s(s.cleanName(t)))])])})),0)]):s._e()]):s._e()])])])])}),[],!1,$t,"4eb2bcb9",null,null);function $t(t){for(let e in Nt)this[e]=Nt[e]}var jt=function(){return Pt.exports}();const Mt=[".nodashboards","nodashboards","nodashboards.txt"],It=new f({html:!0,linkify:!0,typographer:!0});var Ht=i({name:"TabbedDashboardView",components:{DashBoard:g,FolderBrowser:jt},props:{root:{type:String,required:!0},xsubfolder:{type:String,required:!0}},data:()=>({dashboards:[],dashboardDataManager:null,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},isZoomed:!1,styleElement:null,loadErrorMessage:"",activeTab:"",pageHeader:"",folderReadme:"",header:"",footer:"",customCSS:"",dashboardTabWithDelay:"",showFooter:!1}),computed:{fileApi(){return new n(this.fileSystem,d)},fileSystem(){const t=this.$store.state.svnProjects.filter((t=>t.slug===this.root));if(0===t.length)throw console.log("no such project"),Error;return t[0]},wiide(){return this.$store.state.isFullWidth},dashWidthCalculator(){return this.$store.state.dashboardWidth&&this.$store.state.isFullWidth?{maxWidth:this.$store.state.dashboardWidth}:{}}},watch:{root(){this.updateRoute()},xsubfolder(){this.updateRoute()}},methods:{clearStyles(){this.styleElement&&(document.getElementsByTagName("head")[0].removeChild(this.styleElement),this.styleElement=null)},getPageHeader(){return this.xsubfolder?this.xsubfolder.substring(1+this.xsubfolder.lastIndexOf("/")):this.fileSystem.name||this.root},onNavigate(t){this.$emit("navigate",t)},async getFolderReadme(){try{this.folderReadme="";const{files:t}=await this.fileApi.getDirectory(this.xsubfolder),e=t.filter((t=>"readme.md"===t.toLocaleLowerCase()));if(!e.length)return;const s=await this.fileApi.getFileText(`${this.xsubfolder}/${e[0]}`),i=It.render(s);this.folderReadme=i}catch(t){this.folderReadme=""}},async findConfigsAndDashboards(){if(this.loadErrorMessage="",!this.fileApi)return[];await this.fileApi.getChromePermission(this.fileSystem.handle),this.getFolderReadme();try{this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.xsubfolder);const{files:e}=await this.fileApi.getDirectory(this.xsubfolder);let s=!0;if(Mt.forEach((t=>{e.indexOf(t)>-1&&(s=!1)})),s)for(const t of Object.values(this.allConfigFiles.dashboards)){a.set(this.dashboards,t,{header:{tab:"..."}});await this.initDashboard(t)||delete this.dashboards[t]}if(a.set(this.dashboards,"FILE__BROWSER",{header:{tab:"Files"}}),this.$route.query.tab)try{const t=parseInt(""+this.$route.query.tab)-1,e=Object.keys(this.dashboards)[t];this.activeTab=e||Object.keys(this.dashboards)[0]}catch(t){this.activeTab=Object.keys(this.dashboards)[0]}else this.activeTab=Object.keys(this.dashboards)[0];this.dashboardTabWithDelay=this.activeTab,await this.setupProjectConfig()}catch(t){console.warn({eeee:t}),this.fileSystem.handle?this.loadErrorMessage=`Click to grant access to folder "${this.fileSystem.handle.name}"`:this.loadErrorMessage=this.fileSystem.baseURL+": Could not load"}},async setupProjectConfig(){if(Object.keys(this.allConfigFiles.configs).length)for(const e of Object.values(this.allConfigFiles.configs))try{const s=await this.fileApi.getFileText(e),i=p.parse(s),a=e.startsWith("http")?"":e.substring(0,e.indexOf("simwrapper-config.y"));!0===i.hideLeftBar&&this.$store.commit("setShowLeftBar",!1),!1===i.hideLeftBar&&this.$store.commit("setShowLeftBar",!0),this.$store.commit("setFullWidth",!!i.fullWidth),this.$store.commit("setDashboardWidth",""),void 0!==i.width&&(this.$store.commit("setDashboardWidth",""+i.width),this.$store.commit("setFullWidth",!0));try{i.css&&(this.customCSS=await this.fileApi.getFileText(`${a}${i.css}`),this.styleElement=document.createElement("style"),this.styleElement.appendChild(document.createTextNode(this.customCSS)),document.getElementsByTagName("head")[0].appendChild(this.styleElement))}catch(t){}this.header=await this.buildPanel("header",i,a),this.footer=await this.buildPanel("footer",i,a)}catch(t){console.error(""+t)}},handleRemoveDashboard(){},async buildPanel(t,e,s){let i="";if(i="de"===this.$store.state.locale?e[t+"_de"]||e[t]||e[t+"_en"]||"":e[t+"_en"]||e[t]||e[t+"_de"]||"",!i)return"";if(-1==i.indexOf("\n")&&i.endsWith(".md")){i=await this.fileApi.getFileText(`${s}${i}`)}const a=It.render(i);return yt.sanitize(a,{USE_PROFILES:{html:!0}})},async initDashboard(t){var e;try{const s=await this.fileApi.getFileText(t),i=p.parse(s);if(null==(e=i.header)?void 0:e.triggerPattern){const{files:t,dirs:e}=await this.fileApi.getDirectory(this.xsubfolder),s=[...t,...e];if(0===r.match(s,i.header.triggerPattern).length)return!1}const a=t.substring(0,t.lastIndexOf("."));return i.header||(i.header={title:t,tab:a}),i.header.tab||(i.header.tab=i.header.title||a),this.dashboards[t]=i,console.log("DASHBOARD:",t),!0}catch(s){return this.$store.commit("setStatus",{type:u.ERROR,msg:""+s}),!1}},updateRoute(){this.clearStyles(),this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.dashboardDataManager=new y(this.root,this.xsubfolder),this.header="",this.footer="",this.dashboards=[],this.pageHeader=this.getPageHeader(),this.findConfigsAndDashboards()},async switchTab(t,e){t!==this.activeTab&&(this.activeTab="",this.dashboardTabWithDelay="",this.showFooter=!1,await this.$nextTick(),this.activeTab=t,setTimeout((()=>{this.dashboardTabWithDelay=t,e?this.$router.replace({query:{tab:`${e+1}`}}):this.$router.replace({query:{}})}),125))},handleZoom(t){this.isZoomed=!!t,this.$emit("zoom",this.isZoomed)},handleLayoutComplete(){this.showFooter=!0},getFileSystem(t){const e=this.$store.state.svnProjects.filter((e=>e.slug===t));return 0===e.length?(console.warn("no such project"),this.loadErrorMessage=`Can't locate "${t}": please check running services and browser version.`,null):e[0]},goUpOneFolder(){let t=this.xsubfolder;this.xsubfolder.endsWith("/")&&(t=this.xsubfolder.slice(0,length-1)),t=t.substring(0,t.lastIndexOf("/"));const e={root:this.fileSystem.slug,xsubfolder:t};t||this.xsubfolder?this.onNavigate({component:"TabbedDashboardView",props:e}):this.onNavigate({component:"SplashPage",props:{}})},async authorizeAfterError(){try{const t=this.fileSystem.handle;if(t){"granted"===await t.requestPermission({mode:"read"})&&this.updateRoute()}}catch(t){}},setTitle(){const t=this.xsubfolder.startsWith("/")?this.xsubfolder.slice(1):this.xsubfolder,e=`${this.fileSystem.name}: ${t}`;this.$emit("title",e)}},mounted(){this.updateRoute(),this.setTitle()},beforeDestroy(){this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.clearStyles()}});const Wt={};var Bt=l(Ht,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tabbed-folder-view"},[s("div",{staticClass:"centered-vessel",class:{wiide:t.wiide}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isZoomed,expression:"!isZoomed"}],staticClass:"tabholder",style:t.dashWidthCalculator},[s("div",{staticClass:"tabholdercontainer"},[t.header?s("div",{staticClass:"project-header",domProps:{innerHTML:t._s(t.header)}}):t._e(),s("div",{staticClass:"tabs is-centered"},[s("ul",{staticStyle:{"margin-right":"1rem"}},t._l(Object.keys(t.dashboards),(function(e,i){return s("li",{key:e,class:{"is-active":e===t.activeTab,"is-not-active":e!==t.activeTab},style:{opacity:e===t.activeTab?1:.5}},[s("b",[t.dashboards[e].header?s("a",{on:{click:function(s){return t.switchTab(e,i)}}},[t._v(t._s(t.dashboards[e].header.tab))]):t._e()])])})),0)])])]),t.dashboardTabWithDelay&&"FILE__BROWSER"!==t.dashboardTabWithDelay&&t.dashboards[t.dashboardTabWithDelay]&&"..."!==t.dashboards[t.dashboardTabWithDelay].header.tab?s("dash-board",{attrs:{root:t.root,xsubfolder:t.xsubfolder,config:t.dashboards[t.dashboardTabWithDelay],datamanager:t.dashboardDataManager,zoomed:t.isZoomed,allConfigFiles:t.allConfigFiles},on:{zoom:t.handleZoom,layoutComplete:t.handleLayoutComplete}}):t._e(),t.dashboardTabWithDelay&&"FILE__BROWSER"===t.dashboardTabWithDelay?s("folder-browser",{attrs:{root:t.root,xsubfolder:t.xsubfolder,allConfigFiles:t.allConfigFiles},on:{navigate:t.onNavigate,up:function(e){return t.goUpOneFolder()}}}):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showFooter&&!t.isZoomed,expression:"showFooter && !isZoomed"}],staticClass:"tabholder",class:{wiide:t.wiide},style:t.dashWidthCalculator},[s("div",{staticClass:"tabholdercontainer",class:{wiide:t.wiide}},[t.footer?s("div",{staticClass:"project-footer",class:{wiide:t.wiide},domProps:{innerHTML:t._s(t.footer)}}):t._e()])])],1)])}),[],!1,Ut,"28e9d3ef",null,null);function Ut(t){for(let e in Wt)this[e]=Wt[e]}var qt=function(){return Bt.exports}(),Vt=i({name:"FileSystemComponents",data:()=>({sources:[]}),mounted(){this.sources=d.state.svnProjects.filter((t=>!t.hidden&&!t.slug.startsWith("fs")))},methods:{openProjectPage(t){const e=Object.assign({},t);e.component="TabbedDashboardView",e.props={root:t.slug,xsubfolder:""},this.$emit("navigate",e)},openProjectTab(t){window.open(t,"_blank")}}});const Gt={};var Yt=l(Vt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"svn-projects"},t._l(t.sources,(function(e){return s("div",{key:e.url,staticClass:"project",on:{click:[function(s){return t.openProjectPage(e)},function(s){return s.metaKey?t.openProjectTab(e):null},function(s){return s.ctrlKey?t.openProjectTab(e):null}],mouseup:function(s){return"button"in s&&1!==s.button?null:t.openProjectTab(e)}}},[s("div",{staticClass:"desc"},[s("h3",[t._v(t._s(e.name))]),s("p",[t._v(t._s(e.description))])])])})),0)}),[],!1,Zt,"617cdc17",null,null);function Zt(t){for(let e in Gt)this[e]=Gt[e]}var Jt=function(){return Yt.exports}();const Xt={},Kt={};var Qt=l({data:()=>({frontmatter:Xt})},(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"markdown-body"},[s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://simwrapper.github.io/docs"}},[t._v("Documentation and users guide")]),t._v(" including examples and getting started")])]),s("li",[s("p",[s("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[t._v("Source code")]),t._v(" available on Github")])])])])}],!1,te,null,null,null);function te(t){for(let e in Kt)this[e]=Kt[e]}const ee=[{url:"https://www.sfcta.org/",image:"sfcta.png",name:"SFCTA"},{url:"https://vsp.berlin/en/",image:"vsp-logo-300dpi.png",name:"VSP TU-Berlin"},{url:"https://tu.berlin",image:"tu-logo.png",name:"TU Berlin"}];var se=i({name:"SplashPage",i18n:{messages:{en:{"more-info":"Documentation:",tagLine:"the simulation browser and data visualizer from TU&nbsp;Berlin.",privacy:"SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.\n\nSimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted."},de:{"more-info":"FÃ¼r weitere Informationen:",tagLine:"Der Modellergebnis-Browser der TU Berlin."}}},components:{FileSystemProjects:Jt,InfoBottom:function(){return Qt.exports}()},data:()=>({state:d.state,allRoots:[]}),computed:{allLogos:()=>ee.map((t=>({url:t.url,image:`/simwrapper/images/logos/${t.image}`}))),isChrome:()=>!!window.showDirectoryPicker,localFileHandles(){return this.$store.state.localFileHandles.concat().sort(((t,e)=>parseInt(t.key.substring(2))<parseInt(e.key.substring(2))?-1:1))}},methods:{onNavigate(t){this.$emit("navigate",t)},updateShortcuts(){const t=this.state.svnProjects.filter((t=>!t.hidden&&!t.slug.startsWith("fs")));this.allRoots=t},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},clickedOnFolder(t){const{folder:e,root:s,i:i}=t;let a=`${s}`;e&&(a+=`/${e}`),this.$router.push(a)},async clickedBrowseChromeLocalFolder(t){try{const e=await t.handle.requestPermission({mode:"read"});if(console.log(t.handle,e),"granted"!==e)return;h.find((e=>e.slug==t.key))||m(t.handle,t.key);const s={root:t.key};this.clickedOnFolder(s)}catch(e){console.error(""+e)}},async showChromeDirectory(){try{const t=window.showDirectoryPicker(),e=await t,s=m(e,null);this.$router.push(`/simwrapper/${s}/`)}catch(t){}},async clickedDelete(t){const e=this.$store.state.localFileHandles.filter((e=>e.key!==t.key));await o("fs",e),this.$store.commit("setLocalFileSystem",e)}},mounted(){if(!this.state.breadcrumbs.length){const t=[{label:"SimWrapper",url:"/"}];d.commit("setBreadCrumbs",t)}this.updateShortcuts()}});const ie={};var ae=l(se,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"splash-page"},[s("div",{staticClass:"scrolly"},[s("div",{staticClass:"thing-area"},[s("div",{staticClass:"top-area"},[s("div",{staticClass:"simwrapper-logo"},[t.state.isDarkMode?s("img",{attrs:{src:"/simwrapper/assets/SW_logo_yellow.abf06ffb.png"}}):s("img",{attrs:{src:"/simwrapper/assets/SW_logo_purple.175fca9f.png"}})])]),s("div",{staticClass:"middle-area"},[t.isChrome?s("div",{staticClass:"is-chrome"},[s("h3",[t._v("Local Folders")]),t.localFileHandles.length?t._e():s("p",[t._v("Chrome & Edge can browse folders directly:")]),s("div",{staticClass:"roots"},t._l(t.localFileHandles,(function(e){return s("div",{key:e.key,staticClass:"project-root local",on:{click:function(s){return t.clickedBrowseChromeLocalFolder(e)}}},[s("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[t._v(t._s(e.handle.name)),s("i",{staticClass:"fa fa-times",on:{click:function(s){return s.stopPropagation(),t.clickedDelete(e)}}})]),s("p",[t._v("Local folder")])])})),0),s("p",{staticClass:"config-sources"},[s("a",{on:{click:t.showChromeDirectory}},[t._v("Add local folder...")])])]):t._e(),s("h3",{staticStyle:{"margin-top":"1rem"}},[t._v("Browse Data Sources")]),s("div",{staticClass:"roots"},t._l(t.allRoots,(function(e){return s("div",{key:e.slug,staticClass:"project-root",on:{click:function(s){return t.clickedOnFolder({root:e.slug})}}},[s("h5",[t._v(t._s(e.name))]),s("p",[t._v(t._s(e.description))])])})),0),s("p",{staticClass:"config-sources"},[s("a",{on:{click:t.configureSources}},[t._v("Edit data sources...")])]),s("div",{staticClass:"logos"},t._l(t.allLogos,(function(t){return s("a",{attrs:{href:t.url,title:t.name,target:"_blank"}},[s("img",{staticClass:"img-logo",attrs:{src:t.image}})])})),0),t._m(0),t._m(1)])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"legal"},[s("p",[t._v("SimWrapper is open source and available onÂ "),s("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[t._v("GitHub.")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"legal"},[s("p",[s("a",{attrs:{href:"https://vsp.berlin/en/",target:"_blank"}},[t._v("VSPÂ TUÂ Berlin")]),s("a",{attrs:{href:"https://vsp.berlin/impressum/",target:"_blank"}},[t._v("Impressum")]),s("a",{attrs:{href:"https://www.vsp.tu-berlin.de/menue/service/privacy/parameter/en/",target:"_blank"}},[t._v("Privacy")])])])}],!1,oe,"53cc6fc6",null,null);function oe(t){for(let e in ie)this[e]=ie[e]}var ne=function(){return ae.exports}();var re=i({name:"LeftIconPanel",props:{activeSection:{type:String,required:!0}},data:()=>({state:d.state,topSections:[{name:"Files",class:"BrowserPanel",icon:"/simwrapper/assets/files.4e6d24ab.svg"},{name:"Issues",class:"ErrorPanel",icon:"/simwrapper/assets/issues.45ff9b99.svg",colorize:!0}],bottomSections:[{name:"Docs",link:"https://simwrapper.github.io/docs",icon:"/simwrapper/assets/readme.bff70382.svg"},{name:"Settings",class:"SettingsPanel",icon:"/simwrapper/assets/settings.6e19bc2b.svg"}]}),computed:{issueColor(){return this.state.statusErrors.length?"invert(60%) sepia(100%) hue-rotate(310deg) saturate(8.5)":this.state.statusWarnings.length?"invert(75%) sepia(100%) hue-rotate(15deg) saturate(5.5)":"invert(100%)"}},methods:{select(t){this.$emit("activate",t)},buttonStyle(t){const e=this.state.statusErrors.length||this.state.statusWarnings.length?.8:.4;return this.activeSection!==t.name?{opacity:t.colorize?e:.4}:{opacity:1,borderLeft:"3px solid white"}}}});const le={};var ce=l(re,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"left-nav-panel"},[s("div",{staticClass:"top"},t._l(t.topSections,(function(e){return s("button",{key:e.name,staticClass:"item",style:t.buttonStyle(e),on:{click:function(s){return t.select(e)}}},[s("img",{staticClass:"svg-icon",style:{filter:e.colorize?t.issueColor:"invert(100%)"},attrs:{src:e.icon,draggable:!1}}),s("p",[t._v(t._s(e.name))])])})),0),s("div",{staticClass:"bottom"},t._l(t.bottomSections,(function(e){return s("button",{key:e.name,staticClass:"item",style:t.buttonStyle(e),on:{click:function(s){return t.select(e)}}},[s("img",{staticClass:"svg-icon",style:{filter:e.colorize?t.issueColor:"invert(100%)"},attrs:{src:e.icon,draggable:!1}}),s("p",[t._v(t._s(e.name))])])})),0)])}),[],!1,de,"2289cfaf",null,null);function de(t){for(let e in le)this[e]=le[e]}var ue=function(){return ce.exports}();var he=i({name:"ErrorPanel",i18n:{messages:{en:{sync:"Sync folders",theme:"Light/Dark",lang:"EN/DE",split:"Split view"},de:{sync:"Sync",theme:"Hell/Dunkel",lang:"DE/EN",split:"Aufteilen"}}},data:()=>({state:d.state,showDescription:!1,descriptionIndexListWarning:[],descriptionIndexListError:[],isError:!1}),watch:{"$route.path"(){this.clearAllButtons()}},computed:{headerTextColor(){let t={};return this.state.statusWarnings.length&&(t={color:"#fe8"}),this.state.statusErrors.length&&(t={color:"#f66"}),t}},methods:{cleanError:t=>t?t.startsWith("Error: ")?t.slice(7):t:"",clearAllButtons(){this.$store.commit("clearAllErrors"),this.$emit("activate",{name:"Files",class:"BrowserPanel",onlyIfVisible:!0})},toggleShowDescription(t,e){if(this.isError=e,e)if(this.descriptionIndexListError.includes(t)){var s=this.descriptionIndexListError.indexOf(t);this.descriptionIndexListError.splice(s,1)}else this.descriptionIndexListError.push(t);else if(this.descriptionIndexListWarning.includes(t)){s=this.descriptionIndexListWarning.indexOf(t);this.descriptionIndexListWarning.splice(s,1)}else this.descriptionIndexListWarning.push(t)}}});const me={};var fe=l(he,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"panel"},[s("div",{staticClass:"top-panel"},[s("h4",{style:t.headerTextColor},[t._v("Issues")]),s("div",{staticClass:"warnings"},[t.state.statusErrors.length||t.state.statusWarnings.length?s("div",{staticClass:"message-area"},[t.state.statusErrors.length?s("h3",[t._v("Errors: "+t._s(t.state.statusErrors.length))]):t._e(),t._l(t.state.statusErrors,(function(e,i){return s("div",{staticClass:"single-message"},[s("p",{domProps:{innerHTML:t._s(t.cleanError(e.msg))},on:{click:function(e){return t.toggleShowDescription(i,!0)}}}),t.descriptionIndexListError.includes(i)?s("div",{staticClass:"description"},[s("p",{domProps:{innerHTML:t._s(e.desc)}})]):t._e()])})),t.state.statusWarnings.length?s("h3",[t._v("Warnings: "+t._s(t.state.statusWarnings.length))]):t._e(),t._l(t.state.statusWarnings,(function(e,i){return s("div",{staticClass:"single-message"},[s("p",{domProps:{innerHTML:t._s(e.msg)},on:{click:function(e){return t.toggleShowDescription(i,!1)}}}),t.descriptionIndexListWarning.includes(i)?s("div",{staticClass:"description"},[s("p",{domProps:{innerHTML:t._s(e.desc)}})]):t._e()])}))],2):s("div",{staticClass:"no-error"},[s("p",{staticClass:"check"},[t._v("âï¸")]),s("p",[t._v("No issues for this page.")])])])]),s("div",{staticClass:"bottom-panel"},[t.state.statusErrors.length||t.state.statusWarnings.length?s("b-button",{staticClass:"clear-button",attrs:{expanded:""},on:{click:function(e){return t.clearAllButtons()}}},[t._v("Clear all messages")]):t._e()],1)])}),[],!1,pe,"37fd5193",null,null);function pe(t){for(let e in me)this[e]=me[e]}var ge=function(){return fe.exports}();var ve=i({name:"AddDataSource",props:{},data:()=>({labelField:"",urlField:"",noteField:"",notes:"",mdParser:new f}),mounted(){this.notes=this.mdParser.render('\nAdd a local shortcut for any URL-based resource.\nSimWrapper requires several server settings, including:\n\n- Open access (no login)\n- File and directory listings\n-  CORS "Access-Control-Allow-Origin"\n')},watch:{labelField(){this.fixField()}},computed:{isValidURL(){return!!this.labelField&&(!!this.urlField&&!!this.urlField.startsWith("http"))}},methods:{addURL(){this.fixField(),console.log("Adding",this.labelField,this.urlField);const t="projectShortcuts";try{let e=localStorage.getItem(t)||"{}",s=JSON.parse(e);s[this.labelField]={name:`${this.labelField}`,slug:`${this.labelField}`,description:this.noteField,baseURL:this.urlField},console.log("NEW ROOTS",s),localStorage.setItem(t,JSON.stringify(s)),d.commit("setURLShortcuts",s)}catch(e){console.error(""+e)}},fixField(){this.labelField=this.labelField.toLowerCase().replaceAll(/[^a-z\-0-9@]*/g,"")}}});const ye={};var be=l(ve,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-data"},[s("div",{staticClass:"add"},[s("div",{staticClass:"markdown",domProps:{innerHTML:t._s(t.notes)}}),s("div",{staticClass:"flex-row"},[t._m(0),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"e.g. server1",maxlength:"32"},model:{value:t.labelField,callback:function(e){t.labelField=e},expression:"labelField"}})],1),s("div",{staticClass:"flex-row"},[t._m(1),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"http://localhost:8001",maxlength:"512"},model:{value:t.urlField,callback:function(e){t.urlField=e},expression:"urlField"}})],1),s("div",{staticClass:"flex-row"},[t._m(2),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"optional",maxlength:"255"},model:{value:t.noteField,callback:function(e){t.noteField=e},expression:"noteField"}})],1),s("div",{staticClass:"flex-row"},[s("p",{staticClass:"flex1"},[t._v("Â ")]),s("b-button",{staticClass:"is-primary",attrs:{size:"is-small",disabled:!t.isValidURL,type:t.isValidURL?"":"is-outlined"},on:{click:t.addURL}},[t._v("Add Data URL")])],1)])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"flex1"},[s("b",[t._v("Label")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"flex1"},[s("b",[t._v("URL")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"flex1"},[s("b",[t._v("Note")])])}],!1,Se,"3055b930",null,null);function Se(t){for(let e in ye)this[e]=ye[e]}var we=function(){return be.exports}();const Ce=[".nodashboards","nodashboards","nodashboards.txt"],_e={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270",carriers:"#c97A2C",events:"#4400ff",hexagons:"#900564",map:"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"};var ke=i({name:"BrowserPanel",i18n:{messages:{en:{Maps:"Maps & Dashboards",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Table",privacy:"SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.\n\nSimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted."},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Tabelle"}}},components:Object.assign({AddDataSource:we,FileSystemProjects:Jt,TopsheetsFinder:At},c),data:()=>({globalState:d.state,subfolder:"/",root:"",summaryYamlFilename:"viz-summary.yml",highlightedViz:-2,needDoubleClickHint:!1,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},allRoots:[],mdRenderer:new f({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1},clicks:0,clickTimer:{}}),mounted(){this.setupHints(),this.updateShortcuts(),this.getRootAndRoute(this.$route.params.pathMatch)},watch:{"globalState.svnProjects"(){this.updateShortcuts()},"globalState.colorScheme"(){this.fetchFolderContents()},subfolder(){this.updateRoute()},"globalState.authAttempts"(){this.authenticationChanged()},"myState.files"(){this.filesChanged()}},computed:{hasDashboards(){return!!Object.keys(this.allConfigFiles.dashboards).length},vizImages(){const t={};for(let e=0;e<this.myState.vizes.length;e++)"image-view"===this.myState.vizes[e].component&&(t[e]=this.myState.vizes[e]);return t},vizMaps(){const t=["image-view","dashboard"],e=new Map;this.hasDashboards&&e.set(-1,{component:"",title:"Dashboard Panel"});for(let s=0;s<this.myState.vizes.length;s++)t.includes(this.myState.vizes[s].component)||e.set(s,this.myState.vizes[s]);return e},isChrome:()=>!!window.showDirectoryPicker,localFileHandles(){return this.$store.state.localFileHandles.concat().sort(((t,e)=>parseInt(t.key.substring(2))<parseInt(e.key.substring(2))?-1:1))}},methods:{updateRoute(){if(!this.root)return;const t=this.getFileSystem(this.root);this.myState.svnProject=t,this.myState.subfolder=this.subfolder||"",this.myState.readme="",this.highlightedViz=-2,this.myState.svnProject&&(this.myState.svnRoot=new n(this.myState.svnProject,d),this.generateBreadcrumbs(),this.fetchFolderContents())},authenticationChanged(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async filesChanged(){this.myState.vizes=[],0!==this.myState.files.length&&(this.showReadme(),this.myState.summary=-1!==this.myState.files.indexOf(this.summaryYamlFilename),this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),xt(".medium-zoom",{background:"#444450"}))},updateShortcuts(){const t=this.globalState.svnProjects.filter((t=>!t.hidden&&!t.slug.startsWith("fs")));this.allRoots=t},cleanName:t=>decodeURIComponent(t),getFileSystem(t){const e=d.state.svnProjects.filter((e=>e.slug===t));if(0===e.length)throw console.log("no such project"),Error;return e[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const t=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],e=this.myState.subfolder.split("/");let s="/";for(const i of e)i&&(s+=i+"/",t.push({label:i,url:"/"+this.myState.svnProject.slug+s}));return d.commit("setBreadCrumbs",t),t},setupHints(){let t=localStorage.getItem("needsClickHint");t=t?JSON.parse(t):0,t>5e3?this.needDoubleClickHint=!1:(t++,localStorage.setItem("needsClickHint",JSON.stringify(t)))},clickedBreadcrumb(t){this.getRootAndRoute(t.url.slice(1))},getRootAndRoute(t){if(!t)return;if("/"===t)return void(this.root="");if(t.startsWith("split/"))return console.log("SPLIT"),void t.substring(6);let e=t,s="";const i=t.indexOf("/");i>-1&&(e=t.substring(0,i),s=t.substring(i+1)),this.root=e,this.subfolder=s},activateVisualization(t){const e=this.myState.vizes[t]||{component:"TabbedDashboardView",title:"Dashboard"};if("image-view"===e.component)return;if(!this.myState.svnProject)return;this.highlightedViz=-2;const s=this.myState.subfolder.replaceAll("//","/"),i={root:this.myState.svnProject.slug,xsubfolder:s,subfolder:s,yamlConfig:e.config,thumbnail:!1};this.$emit("navigate",{component:e.component,props:i})},updateTitle(t,e){this.myState.vizes[t].title=e},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},getTabColor:t=>({backgroundColor:_e[t]||"#8778BB"}),async showReadme(){this.myState.readme="";const t="readme.md";if(this.myState.files.map((t=>t.toLocaleLowerCase())).indexOf(t)>-1){if(!this.myState.svnRoot)return;const e=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+t);this.myState.readme=this.mdRenderer.render(e)}},buildShowEverythingView(){for(const t of this.globalState.visualizationTypes.values()){const e=r(this.myState.files,t.filePatterns);for(const s of e)this.myState.vizes.push({component:t.kebabName,config:s,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const t=p.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const e of t.plugins){const s=this.globalState.visualizationTypes.get(e);if(s)if(t[s.kebabName])for(const e of t[s.kebabName]){const t=await this.findMatchingFiles(e);for(const e of t)this.myState.vizes.push({component:s.kebabName,config:e,title:e})}else{const t=r(this.myState.files,s.filePatterns);for(const e of t)this.myState.vizes.push({component:s.kebabName,config:e,title:".."})}}},async findMatchingFiles(t){if(this.myState.files.indexOf(t)>-1)return[t];const e=r(this.myState.files,t);if(e.length)return e;if(!this.myState.svnRoot)return[];try{const e=t.split("/"),s=this.myState.subfolder+"/"+e[0];console.log(s);const i=await this.myState.svnRoot.getDirectory(s);return r(i.files,e[1]).map((t=>e[0]+"/"+t))}catch(s){}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{this.allConfigFiles=await this.findAllConfigsAndDashboards();const t=await this.myState.svnRoot.getDirectory(this.myState.subfolder),e=t.dirs.filter((t=>!t.startsWith("."))).sort(),s=t.files.filter((t=>!t.startsWith("."))).sort(),i=Object.assign({},this.allConfigFiles.vizes);for(const o of s)i[o]=o;const a=Object.values(i);this.myState.errorStatus="",this.myState.folders=["UP"].concat(e),this.myState.files=a}catch(t){const e=this.myState.subfolder.lastIndexOf("/");return e>-1?void(this.subfolder=this.myState.subfolder.slice(0,e)):void(this.subfolder="")}finally{this.myState.isLoading=!1}},clickedVisualization(t){if(this.myState.isLoading)return;this.highlightedViz=t,this.clicks++,1===this.clicks?this.clickTimer=setTimeout((()=>{this.needDoubleClickHint=!0,this.clicks=0}),450):(clearTimeout(this.clickTimer),this.needDoubleClickHint=!1,this.activateVisualization(t),this.clicks=0)},clickedOnFolder(t){this.needDoubleClickHint=!1;const{folder:e,root:s,i:i}=t;if(s)return this.root=s,this.subfolder="",void this.updateRoute();if(!this.myState.isLoading&&this.myState.svnProject)if(0!=i||"UP"!==e)this.subfolder=`${this.subfolder}/${e}`;else if("/"===this.subfolder||""===this.subfolder)this.root="";else{const t=this.subfolder.lastIndexOf("/");this.subfolder=t>-1?this.subfolder.slice(0,t):"/"}},handleSingleClickFolder(t){const{folder:e,root:s,i:i}=t;if(s)return this.root=s,this.subfolder="",void this.updateRoute();if(this.myState.isLoading)return;if(!this.myState.svnProject)return;if(0==i&&"UP"===e)return;const a=".."===e?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+e,o={root:this.myState.svnProject.slug,xsubfolder:a};a||this.myState.subfolder?this.$emit("navigate",{component:"TabbedDashboardView",props:o}):this.$emit("navigate",{component:"SplashPage",props:{}})},dragEnd(){this.$emit("isDragging",!1)},dragStart(t,e){var s;this.$emit("isDragging",!0);const i=Object.assign({},e,{root:this.root,subfolder:this.myState.subfolder,xsubfolder:this.myState.subfolder});i.yamlConfig=i.config,delete i.config;const a=JSON.stringify(i);null==(s=t.dataTransfer)||s.setData("bundle",a)},clickedLogo(){this.$router.push("/")},async findAllConfigsAndDashboards(){if(!this.myState.svnRoot)return{dashboards:{},configs:{},vizes:{},topsheets:{}};try{const{files:t}=await this.myState.svnRoot.getDirectory(this.subfolder);let e=!0;Ce.forEach((s=>{t.indexOf(s)>-1&&(e=!1)}));const s=await this.myState.svnRoot.findAllYamlConfigs(this.subfolder);return e||(s.dashboards={}),s}catch(t){return{dashboards:{},configs:{},vizes:{},topsheets:{}}}},async clickedBrowseChromeLocalFolder(t){try{const e=await t.handle.requestPermission({mode:"read"});if(console.log(t.handle,e),"granted"!==e)return;h.find((e=>e.slug==t.key))||m(t.handle,t.key);const s={root:t.key};this.clickedOnFolder(s)}catch(e){console.error(""+e)}},async showChromeDirectory(){try{const t=window.showDirectoryPicker(),e=await t,s=m(e,null);this.$router.push(`/simwrapper/${s}/`)}catch(t){}},async clickedDelete(t){const e=this.$store.state.localFileHandles.filter((e=>e.key!==t.key));await o("fs",e),this.$store.commit("setLocalFileSystem",e)}}});const Te={};var Ee=l(ke,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"panel"},[s("div",{staticClass:"top-panel"},[s("h4",[t._v("Files")]),t.root?s("div",{staticClass:"trail"},[s("div",{staticClass:"x-home"},[s("p",{on:{click:function(e){return t.clickedBreadcrumb({url:"//"})}}},[s("i",{staticClass:"fa fa-home"})])]),t.root?s("div",{staticClass:"x-breadcrumbs"},t._l(t.globalState.breadcrumbs.slice(1),(function(e,i){return s("p",{key:e.url,on:{click:function(s){return t.clickedBreadcrumb(e)}}},[t._v("Â /Â "+t._s(e.label))])})),0):t._e()]):t._e()]),s("div",{staticClass:"middle-panel"},[t.root?s("div",{staticClass:"curated-sections"},[s("h3",{staticClass:"curate-heading"},[t._v(t._s(t.globalState.breadcrumbs[t.globalState.breadcrumbs.length-1].label))]),t.myState.folders.length?s("div",{staticClass:"curate-content"},[s("div",{staticClass:"folder-table"},t._l(t.myState.folders,(function(e,i){return s("div",{key:e,staticClass:"folder",class:{fade:t.myState.isLoading,upfolder:0==i},on:{click:function(s){return t.clickedOnFolder({folder:e,i:i})}}},[s("i",{staticClass:"fa",class:0==i?"fa-arrow-up":"fa-folder-open"}),s("p",[t._v(t._s(t.cleanName(e)))])])})),0),1==t.myState.folders.length?s("p",{staticStyle:{"font-size":"0.9rem",opacity:"0.7",margin:"0.5rem 0","text-align":"right"}},[t._v("No subfolders.")]):t._e()]):t._e(),t.vizMaps.size?s("div",{staticClass:"section-maps"},[s("h3",{staticClass:"curate-heading"},[t._v(t._s(t.$t("Maps")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-table"},t._l(t.vizMaps.entries(),(function(e){var i=e[0],a=e[1];return s("div",{key:i,staticClass:"viz-grid-item",on:{click:function(e){return t.clickedVisualization(i)}}},[s("div",{staticClass:"viz-frame",class:{highlighted:i===t.highlightedViz},attrs:{draggable:""},on:{dragstart:function(e){return t.dragStart(e,a)},dragend:t.dragEnd}},[s("p",{staticClass:"v-title"},[s("b",[t._v(t._s(a.title))])]),s("p",{staticClass:"v-filename"},[t._v(t._s(a.config))]),s("p",{staticClass:"v-plugin",style:t.getTabColor(a.component)},[t._v(t._s(a.component||"dashboard"))]),s(a.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:t.myState.svnProject.slug,subfolder:t.myState.subfolder,yamlConfig:a.config,thumbnail:!0,fileApi:t.myState.svnRoot},on:{title:function(e){return t.updateTitle(i,e)}}})],1)])})),0),s("div",{staticClass:"hint-clicks",style:{opacity:t.needDoubleClickHint?1:0}},[t._m(1)])])]):t._e(),Object.keys(t.vizImages).length?s("div",{staticClass:"section-images"},[s("h3",{staticClass:"curate-heading"},[t._v(t._s(t.$t("Images")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-image-table"},t._l(Object.entries(t.vizImages),(function(e){var i=e[0],a=e[1];return s("div",{key:i,staticClass:"viz-image-grid-item",on:{click:function(e){return t.clickedVisualization(i)}}},[s("div",{staticClass:"viz-image-frame"},[s(a.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:t.myState.svnProject.slug,subfolder:t.myState.subfolder,yamlConfig:a.config,thumbnail:!0,fileApi:t.myState.svnRoot},on:{title:function(e){return t.updateTitle(i,e)}}}),s("p",[t._v(t._s(a.title))])],1)])})),0)])]):t._e()]):s("div",{staticClass:"curated-sections"},[t._m(0),t.isChrome?s("div",{staticClass:"is-chrome"},[s("h3",[t._v("Local Folders")]),t.localFileHandles.length?t._e():s("p",[t._v("Chrome & Edge can browse folders directly:")]),t._l(t.localFileHandles,(function(e){return s("div",{key:e.key,staticClass:"project-root local",on:{click:function(s){return t.clickedBrowseChromeLocalFolder(e)}}},[s("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[t._v(t._s(e.handle.name)),s("i",{staticClass:"fa fa-times",on:{click:function(s){return s.stopPropagation(),t.clickedDelete(e)}}})]),s("p",[t._v("Local folder")])])})),s("p",{staticClass:"config-sources"},[s("a",{on:{click:t.showChromeDirectory}},[t._v("Add local folder...")])])],2):t._e(),s("h3",{staticStyle:{"margin-top":"1rem"}},[t._v("Data Sources")]),t._l(t.allRoots,(function(e){return s("div",{key:e.slug,staticClass:"project-root",on:{click:function(s){return t.clickedOnFolder({root:e.slug})}}},[s("h5",[t._v(t._s(e.name))]),s("p",[t._v(t._s(e.description))])])})),s("p",{staticClass:"config-sources"},[s("a",{on:{click:t.configureSources}},[t._v("Edit data sources...")])])],2)])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hint-clicks",staticStyle:{"margin-bottom":"1rem",opacity:"1"}},[s("p",[t._v("You can browse to another folder from here. Drag panels into the main window area to open them side-by-side.")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("b",[t._v("Drag")]),t._v("Â orÂ "),s("b",[t._v("double-click")]),t._v("Â a tile"),s("br"),t._v("to open it in the main panel")])}],!1,xe,"351541a6",null,null);function xe(t){for(let e in Te)this[e]=Te[e]}var De=function(){return Ee.exports}();var Le=i({name:"SettingsPanel",components:{AddDataSource:we},i18n:{messages:{en:{translate:"Note: German translations are incomplete, but steadily improving",theme:"Theme",light:"Light",dark:"Dark",language:"Language",dataSources:"Data Sources",addDataSources:"Add Data Source"},de:{translate:"Die Ãbersetzungen sind unvollstÃ¤ndig, werden aber immer besser...",theme:"Thema",light:"Hell",dark:"Dunkel",language:"Sprache",dataSources:"Datenquellen"}}},data:()=>({state:d.state,theme:"",shortcuts:[]}),mounted(){this.theme=this.state.isDarkMode?"dark":"light",this.setupShortcuts()},watch:{"state.svnProjects"(){this.setupShortcuts()},"state.isDarkMode"(){console.log("ooop!",this.state.isDarkMode),this.theme=this.state.isDarkMode?"dark":"light"}},computed:{isLight(){return"light"==this.theme?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDark(){return"dark"==this.theme?{backgroundColor:"#7957d5",color:"white",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isEN(){return"en"==this.state.locale?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDE(){return"de"==this.state.locale?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}}},methods:{setupShortcuts(){try{const t=localStorage.getItem("projectShortcuts");if(t){const e=JSON.parse(t);this.shortcuts=Object.values(e)}}catch(t){console.error("ERROR MERGING URL SHORTCUTS:",""+t)}},deleteShortcut(t){try{const e=localStorage.getItem("projectShortcuts");if(e){const s=JSON.parse(e);delete s[t],localStorage.setItem("projectShortcuts",JSON.stringify(s)),d.commit("removeURLShortcut",t),this.shortcuts=Object.values(s)}}catch(e){console.error("ERROR MERGING URL SHORTCUTS:",""+e)}},setTheme(t){this.theme=t,console.log(this.theme),d.commit("setTheme",t)},setLanguage(t){this.$store.commit("setLocale",t),this.$root.$i18n.locale=t}}});const ze={};var Fe=l(Le,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"panel"},[t._m(0),s("div",{staticClass:"middle-panel"},[s("div",{staticClass:"option"},[s("h5",[t._v(t._s(t.$t("theme")))]),s("b-button",{staticClass:"button is-white",style:t.isLight,attrs:{outlined:""},on:{click:function(e){return t.setTheme("light")}}},[t._v(t._s(t.$t("light")))]),s("b-button",{staticClass:"button is-gray",style:t.isDark,attrs:{outlined:""},on:{click:function(e){return t.setTheme("dark")}}},[t._v(t._s(t.$t("dark")))])],1),s("div",{staticClass:"option"},[s("h5",[t._v(t._s(t.$t("language")))]),s("b-button",{staticClass:"button is-white",style:t.isEN,attrs:{outlined:""},on:{click:function(e){return t.setLanguage("en")}}},[t._v("EN")]),s("b-button",{staticClass:"button is-gray",style:t.isDE,attrs:{outlined:""},on:{click:function(e){return t.setLanguage("de")}}},[t._v("DE")])],1),s("div",{staticClass:"option"},[s("h5",[t._v(t._s(t.$t("dataSources")))]),t._l(t.shortcuts,(function(e){return s("div",{key:e.slug,staticClass:"source flex-row"},[s("div",{staticClass:"desc flex1"},[s("p",[s("b",[t._v(t._s(e.slug))])]),s("p",[t._v(t._s(e.description))])]),s("div",{staticClass:"delete",on:{click:function(s){return t.deleteShortcut(e.slug)}}})])}))],2),s("div",{staticClass:"option"},[s("h5",[t._v(t._s(t.$t("addDataSources")))]),s("add-data-source")],1)])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"top-panel"},[s("h4",[t._v("Settings")])])}],!1,Ae,"634561f2",null,null);function Ae(t){for(let e in ze)this[e]=ze[e]}var Oe=function(){return Fe.exports}();const Re="/simwrapper/";var Ne=i({name:"LayoutManager",i18n:{messages:{en:{close:"Close panel",back:"Go back"},de:{close:"SchlieÃen",back:"ZurÃ¼ck"}}},components:Object.assign({LeftIconPanel:ue,BrowserPanel:De,FolderBrowser:jt,ErrorPanel:ge,SettingsPanel:Oe,SplashPage:ne,TabbedDashboardView:qt},c),data:()=>({panels:[],leftSections:["BrowserPanel","ErrorPanel","SettingsPanel"],panelsWithScrollbars:["TabbedDashboardView","FolderBrowser","calc-table"],zoomed:!1,isEmbedded:!1,fullScreenPanel:{x:-1,y:-1},activeLeftSection:{name:"Files",class:"BrowserPanel"},leftSectionWidth:300,isDraggingDivider:0,dragStartWidth:0,quadrant:null,dragX:-1,dragY:-1,isDragHappening:!1,isShowingActiveSection:!1,authHandles:[]}),computed:{isMultipanel(){return this.panels.length>1||this.panels[0].length>1},showLeftBar(){return this.$store.state.isShowingLeftBar},activeSectionStyle(){return this.activeLeftSection?{width:`${this.leftSectionWidth}px`}:{display:"none"}}},watch:{"$store.state.statusErrors"(){this.$store.state.statusErrors.length&&(this.activeLeftSection={name:"Issues",class:"ErrorPanel"})},$route(t,e){t.path===Re?this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]]:(this.buildLayoutFromURL(),d.commit("resize"))}},methods:{setActiveLeftSection(t){t.section.onlyIfVisible&&!this.isShowingActiveSection||(this.isShowingActiveSection&&t.section.name===this.activeLeftSection.name?t.toggle&&(this.isShowingActiveSection=!1):t.section.link?window.open(t.section.link,"_blank"):(this.isShowingActiveSection=!0,this.activeLeftSection=t.section,localStorage.setItem("activeLeftSection",JSON.stringify(t.section)),this.leftSectionWidth<48&&(this.leftSectionWidth=300)))},buildLayoutFromURL(){let t=this.$route.params.pathMatch;if(t.startsWith("/")&&(t=t.slice(1)),!t||"/"===t)return void(this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]]);if(t.startsWith("split/")){const e=t.substring(6);try{const t=atob(e),s=JSON.parse(t);this.panels=s}catch(m){console.error("PARSING SPLIT"+m),this.$router.replace("/")}return}let e=t,s="";const i=t.indexOf("/");i>-1&&(e=t.substring(0,i),s=t.substring(i+1));const a=t.substring(1+t.lastIndexOf("/")),o=a.toLocaleLowerCase();for(const f of d.state.visualizationTypes.values())if(r.isMatch(o,f.filePatterns)){if(1===this.panels.length&&1===this.panels[0].length)this.panels=[[this.panels[0][0]]];else{let t=Math.random();this.panels=[[{key:t,component:f.kebabName,title:"",description:"",props:{root:e,subfolder:s.substring(0,s.lastIndexOf("/")),yamlConfig:a,thumbnail:!1}}]]}return}let n=Math.random();1===this.panels.length&&1===this.panels[0].length&&(n=this.panels[0][0].key);const l=this.$store.state.svnProjects.filter((t=>t.slug===e));if(!l.length)throw Error("no such project");const c=l[0],u=s.startsWith("/")?s.slice(1):s,h=`${c.name}: ${u}`;this.panels=[[{key:n,title:h,component:"TabbedDashboardView",props:{root:e,xsubfolder:s}}]]},handleDragStartStop(t){this.isDragHappening=t},buildDragHighlightStyle(t,e){if(-1==t){return{top:0,opacity:"rowTop"==this.quadrant?"1":"0",pointerEvents:this.isDragHappening?"auto":"none",backgroundColor:"#ffcc4480"}}if(-2==t){return{bottom:0,opacity:"rowBottom"==this.quadrant?"1":"0",pointerEvents:this.isDragHappening?"auto":"none",backgroundColor:"#ffcc4480"}}if(t!==this.dragX||e!==this.dragY||!this.quadrant)return{};const s={opacity:1,backgroundColor:"center"==this.quadrant.quadrant?"#079f6f80":"#4444dd90"};return Object.entries(this.quadrant).forEach((t=>s[t[0]]=`${t[1]}px`)),s},stillDragging(t){const{event:e,x:s,y:i,row:a}=t;if(a)return void(this.quadrant=a);this.dragX=s,this.dragY=i;const o=this.$refs[`dragContainer${s}-${i}`],n=this.$refs.tileTable.offsetLeft,r=o[0],l=(e.clientX-r.offsetLeft-n)/r.offsetWidth;e.clientY,r.offsetTop,r.offsetHeight;let c=8;if(l<.3)this.quadrant={quadrant:"left",width:r.offsetWidth/2-2*c,height:r.offsetHeight-2*c,marginLeft:c,marginTop:c};else if(l>.7)this.quadrant={quadrant:"right",width:r.offsetWidth/2-2*c,height:r.offsetHeight-2*c,marginLeft:r.offsetWidth/2+c,marginTop:c};else{c*=5;const t=.95*(r.offsetWidth-2*c),e=.95*(r.offsetHeight-2*c);this.quadrant={quadrant:"center",width:t,height:e,marginLeft:(r.offsetWidth-t)/2,marginTop:(r.offsetHeight-e)/2}}},dragEnd(){this.quadrant=null,this.dragX=-1,this.dragY=-1},onDrop(t){var e;if(!this.quadrant)return;const{event:s,x:i,y:a,row:o}=t;try{const t=null==(e=s.dataTransfer)?void 0:e.getData("bundle"),n=JSON.parse(t),r={component:n.component||"TabbedDashboardView",props:n};this.onSplit({x:i,y:a,row:o,quadrant:this.quadrant.quadrant,viz:r})}catch(n){console.warn(""+n)}this.dragEnd()},async onSplit(t){const{x:e,y:s,row:i,quadrant:a,viz:o}=t,n={component:o.component,props:o.props,title:"",description:"",key:Math.random()};if(i)switch(i){case"rowTop":this.panels.unshift([n]);break;case"rowBottom":this.panels.push([n]);break;default:console.warn("HUH?",i)}else switch(a){case"center":this.panels[s][e]=n;break;case"left":this.panels[s].splice(e,0,n);break;case"right":this.panels[s].splice(e+1,0,n);break;default:return void console.warn("TOP AND BOTTOM to be added later")}this.updateURL(),d.commit("resize")},onNavigate(t,e,s){"SplashPage"===t.component?this.panels[s][e]={component:"SplashPage",props:{},key:Math.random()}:this.panels[s][e]=Object.assign({key:Math.random()},t),this.updateURL(),this.buildLayoutFromURL()},onClose(t,e){this.panels[e][t].component=null,this.panels[e].splice(t,1),this.panels[e].length||(this.panels.length>1?this.panels.splice(e,1):this.panels[0].push({component:"SplashPage",key:Math.random(),props:{}})),this.updateURL(),d.commit("resize")},onBack(t,e){this.panels[e][t].component="TabbedDashboardView",this.panels[e][t].props.xsubfolder=this.panels[e][t].props.subfolder,delete this.panels[e][t].props.yamlConfig,this.updateURL()},getShowHeader(t){return"SplashPage"!==t.component&&(!!this.showLeftBar||(1!=this.panels.length||1!=this.panels[0].length))},updateURL(){if(1===this.panels.length&&1===this.panels[0].length){const t=this.panels[0][0].props,e=t.root||"",s=t.xsubfolder||t.subfolder||"",i=t.yamlConfig||"";if(i.indexOf("/")>-1){const t=i.substring(i.lastIndexOf("/"));this.$router.replace(`${Re}${e}/${s}/${t}`)}else if(i)this.$router.push(`${Re}${e}/${s}/${i}`);else{let i=`${Re}${e}/${s}`;t.config&&(i+=`/${t.config}`),this.$router.push(i)}}else{const t=btoa(JSON.stringify(this.panels));this.$router.push(`${Re}split/${t}`)}},cleanProps(i){const a=i,{title:o}=a;return((i,a)=>{var o={};for(var n in i)e.call(i,n)&&a.indexOf(n)<0&&(o[n]=i[n]);if(null!=i&&t)for(var n of t(i))a.indexOf(n)<0&&s.call(i,n)&&(o[n]=i[n]);return o})(a,["title"])},dividerDragStart(t){this.isDraggingDivider=t.clientX,this.dragStartWidth=this.leftSectionWidth},dividerDragEnd(t){this.isDraggingDivider=0},dividerDragging(t){if(!this.isDraggingDivider)return;const e=t.clientX-this.isDraggingDivider;this.leftSectionWidth=Math.max(0,this.dragStartWidth+e),localStorage.setItem("leftPanelWidth",`${this.leftSectionWidth}`)},setCardTitles(t,e){"string"==typeof e?(a.set(t,"title",e),t.description=""):(t.title=e.title,t.description=e.description||"")},async handleToggleInfoClicked(t){console.log("CARD INFO?",t)},async toggleZoom(t,e,s){console.log("ZOOM",t),this.fullScreenPanel.x>-1?this.fullScreenPanel={x:-1,y:-1}:this.fullScreenPanel={x:e,y:s}},updateDimensions(t){},getTileStyle(t){return{overflow:this.panelsWithScrollbars.includes(t.component)?"auto":"hidden"}},getContainerStyle(t,e,s){let i={padding:this.isMultipanel?"5px 5px":"0"};return-1==this.fullScreenPanel.x||(this.fullScreenPanel.x!==e?i.display="none":i={position:"absolute",top:0,bottom:0,left:0,right:0,margin:"5px 5px"}),i}},mounted(){"embed"in this.$route.query&&(this.isEmbedded=!0);const t=localStorage.getItem("leftPanelWidth");this.leftSectionWidth=null==t?300:parseInt(t),this.leftSectionWidth<0&&(this.leftSectionWidth=2);const e=localStorage.getItem("activeLeftSection");if(e)try{this.activeLeftSection=JSON.parse(e)}catch(s){this.activeLeftSection={name:"Files",class:"BrowserPanel"}}else this.activeLeftSection={name:"Files",class:"BrowserPanel"};this.buildLayoutFromURL()}});const Pe={};var $e=l(Ne,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{style:{userSelect:t.isDraggingDivider?"none":"unset"},attrs:{id:"split-screen"},on:{mousemove:t.dividerDragging,mouseup:t.dividerDragEnd}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showLeftBar,expression:"showLeftBar"}],staticClass:"left-panel"},[s("left-icon-panel",{attrs:{activeSection:t.activeLeftSection.name},on:{activate:function(e){return t.setActiveLeftSection({section:e,toggle:!0})}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowingActiveSection,expression:"isShowingActiveSection"}],staticClass:"left-panel-active-section",style:t.activeSectionStyle},t._l(t.leftSections,(function(e){return s(e,{directives:[{name:"show",rawName:"v-show",value:e==t.activeLeftSection.class,expression:"section==activeLeftSection.class"}],key:e,tag:"component",on:{navigate:function(e){return t.onNavigate(e,0,0)},activate:function(e){return t.setActiveLeftSection({section:e,toggle:!1})},isDragging:t.handleDragStartStop}})})),1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.activeLeftSection,expression:"activeLeftSection"}],staticClass:"left-panel-divider",on:{mousedown:t.dividerDragStart,mouseup:t.dividerDragEnd,mousemove:function(e){return e.stopPropagation(),t.dividerDragging.apply(null,arguments)}}})],1),s("div",{ref:"tileTable",staticClass:"table-of-tiles"},[t.authHandles.length?s("div",{staticClass:"authorization-strip"},t._l(t.authHandles,(function(e){return s("div",{staticClass:"auth-row"},[s("p",{staticClass:"flex1"},[t._v(t._s(""+e))]),s("b-button",[t._v("hello")])],1)})),0):t._e(),s("div",{staticClass:"row-drop-target",style:t.buildDragHighlightStyle(-1,-1),on:{drop:function(e){return t.onDrop({event:e,row:"rowTop"})},dragover:[function(e){return t.stillDragging({event:e,row:"rowTop"})},function(t){t.preventDefault()}],dragenter:function(t){t.preventDefault()},dragleave:t.dragEnd}}),t._l(t.panels,(function(e,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:-1==t.fullScreenPanel.y||t.fullScreenPanel.y==i,expression:"fullScreenPanel.y == -1 || fullScreenPanel.y == y"}],key:i,staticClass:"tile-row"},t._l(e,(function(e,a){return s("div",{key:e.key,ref:`dragContainer${a}-${i}`,refInFor:!0,staticClass:"drag-container",style:t.getContainerStyle(e,a,i),on:{drop:function(e){return t.onDrop({event:e,x:a,y:i})},dragover:[function(t){t.preventDefault()},function(e){return t.stillDragging({event:e,x:a,y:i})}],dragenter:function(t){t.preventDefault()},dragleave:t.dragEnd}},[t.getShowHeader(e)?s("div",{staticClass:"tile-header flex-row"},[s("div",{staticClass:"tile-labels"},[s("h3",{style:{textAlign:t.isMultipanel?"left":"center"}},[t._v(t._s(e.title))]),e.description?s("p",[t._v(t._s(e.description))]):t._e()]),s("div",{staticClass:"tile-buttons"},[e.info?s("div",{staticClass:"nav-button is-small is-white",on:{click:function(s){return t.handleToggleInfoClicked(e)}}},[s("i",{staticClass:"fa fa-info-circle"})]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.panels.length>1||t.panels[0].length>1,expression:"panels.length > 1 || panels[0].length > 1"}],staticClass:"nav-button is-small is-white",attrs:{title:t.fullScreenPanel.x>-1?"Restore":"Enlarge"},on:{click:function(s){return t.toggleZoom(e,a,i)}}},[s("i",{staticClass:"fa fa-expand"})]),s("div",{staticClass:"nav-button is-small is-white",attrs:{title:"Close"},on:{click:function(e){return t.onClose(a,i)}}},[s("i",{staticClass:"fa fa-times-circle"})])])]):t._e(),s(e.component,t._b({tag:"component",staticClass:"map-tile",style:t.getTileStyle(e),on:{navigate:function(e){return t.onNavigate(e,a,i)},title:function(s){return t.setCardTitles(e,s)},activate:function(e){return t.setActiveLeftSection({section:e,toggle:!0})}}},"component",t.cleanProps(e.props),!1)),t.isDragHappening?s("div",{staticClass:"drag-highlight",style:t.buildDragHighlightStyle(a,i)}):t._e()],1)})),0)})),t.isDragHappening?s("div",{staticClass:"row-drop-target",style:t.buildDragHighlightStyle(-2,-2),on:{drop:function(e){return t.onDrop({event:e,row:"rowBottom"})},dragover:[function(e){return t.stillDragging({event:e,row:"rowBottom"})},function(t){t.preventDefault()}],dragenter:function(t){t.preventDefault()},dragleave:t.dragEnd}}):t._e()],2)])}),[],!1,je,"33272ba0",null,null);function je(t){for(let e in Pe)this[e]=Pe[e]}var Me=function(){return $e.exports}();export{Me as default};
//# sourceMappingURL=LayoutManager.36ede84d.js.map
