import{d as t}from"./vendor.e9c367ae.js";import{g as e,n as i}from"./index.2deacc07.js";const s=t({name:"VideoPlayerPlugin",props:{root:{type:String,required:!0},subfolder:{type:String,required:!0},yamlConfig:String,config:Object,thumbnail:Boolean},data:()=>({movieSource:"",title:"",myState:{},fileApi:null,playerOptions:{muted:!1,language:"en",playbackRates:[.5,1,1.5,2,5],preload:"metadata",responsive:!0,fluid:!1,playsInline:!0,controls:!0,sources:[]}}),beforeDestroy(){this.thumbnail||e.commit("setFullScreen",!1)},mounted(){this.fileApi=this.getFileSystem(this.root),this.myState={subfolder:this.subfolder,yamlConfig:this.yamlConfig,thumbnail:this.thumbnail,imageData:""},this.playerOptions.fluid=!!this.thumbnail,this.thumbnail||e.commit("setFullScreen",!0),this.yamlConfig?(this.myState.subfolder=this.subfolder,this.myState.yamlConfig=this.yamlConfig,this.buildMovieSource()):this.buildRouteFromUrl(),this.getVizDetails()},watch:{yamlConfig(){this.myState.yamlConfig=this.yamlConfig,this.getVizDetails()},subfolder(){this.myState.subfolder=this.subfolder,this.getVizDetails()}},methods:{buildMovieSource(){var t;this.movieSource=`${null==(t=this.fileApi)?void 0:t.baseURL}/${this.myState.subfolder}/${this.myState.yamlConfig}`,this.playerOptions.sources.push({type:"video/mp4",src:this.movieSource})},getFileSystem(t){const e=this.$store.state.svnProjects.filter((e=>e.slug===t));if(0===e.length)throw console.log("no such project"),Error;return e[0]},async buildRouteFromUrl(){const t=this.$route.params;if(!t.project||!t.pathMatch)return void console.log("I CANT EVEN: NO PROJECT/PARHMATCH");this.fileApi=this.getFileSystem(t.project);const e=1+t.pathMatch.lastIndexOf("/"),i=t.pathMatch.substring(0,e),s=t.pathMatch.substring(e);this.myState.subfolder=i,this.myState.yamlConfig=s,this.buildMovieSource()},async generateBreadcrumbs(){const t=this.getFileSystem(this.$route.params.project);if(!t)return[];const i=[{label:t.name,url:"/"+t.slug}],s=this.myState.subfolder.split("/");let o="/";for(const e of s)e&&(o+=e+"/",i.push({label:e,url:"/"+t.slug+o}));return e.commit("setBreadCrumbs",i),i},async getVizDetails(){this.title=this.myState.yamlConfig.replace(/_/g," "),this.title=this.title.substring(0,this.title.lastIndexOf(".")),this.title&&this.$emit("title",this.title)}}});const o={};var l=i(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-plugin-container",class:{thumbnail:t.thumbnail}},[t.thumbnail?t._e():i("h3",[t._v(t._s(t.title))]),i("div",{staticClass:"vid-container"},[i("video",{attrs:{controls:t.controls,loop:t.loop,allowfullscreen:t.allowfullscreen,autoplay:t.autoplay},domProps:{muted:t.muted}},[t._l(t.sources,(function(t,e){return i("source",{key:e,attrs:{src:t,type:e}})})),t._l(t.sources,(function(e,s){return i("p",{key:s},[t._v("Video tag not supported. Download the videoÂ "),i("a",{attrs:{href:e,target:"_blank"}},[t._v("here")])])}))],2)])])}),[],!1,r,"236ee6d2",null,null);function r(t){for(let e in o)this[e]=o[e]}var a=function(){return l.exports}();export{a as default};
//# sourceMappingURL=VideoPlayer.d20302fb.js.map
