{"version":3,"file":"PathOffsetLayer.f28047a8.js","sources":["../../src/layers/PathOffsetLayer.ts"],"sourcesContent":["import { PathLayer } from '@deck.gl/layers'\r\n\r\nconst OFFSET_TYPE = {\r\n  NONE: 0,\r\n  LEFT: 1,\r\n  RIGHT: 2,\r\n}\r\n\r\nexport default class PathOffsetLayer extends PathLayer {\r\n  initializeState(context: any) {\r\n    super.initializeState(context)\r\n\r\n    this.getAttributeManager().addInstanced({\r\n      instanceOffset: {\r\n        size: 1,\r\n        accessor: 'getOffset',\r\n      },\r\n    })\r\n  }\r\n\r\n  getShaders() {\r\n    return {\r\n      ...super.getShaders(),\r\n      inject: {\r\n        'vs:#decl': `\r\n            attribute float instanceOffset;\r\n            varying float offset;\r\n            `,\r\n        'vs:#main-start': `\r\n            offset = instanceOffset;\r\n            `,\r\n        'fs:#decl': `\r\n            varying float offset;\r\n            `,\r\n        'fs:#main-start': `\r\n            if (offset == 1.0 && vPathPosition.x < 0.0) {\r\n                discard;\r\n            }\r\n            if (offset == 2.0 && vPathPosition.x > 0.0) {\r\n                discard;\r\n            }\r\n            if (offset == 0.0 && abs(vPathPosition.x) > 0.5) {\r\n                discard;\r\n            }\r\n        `,\r\n      },\r\n    }\r\n  }\r\n}\r\n\r\nPathOffsetLayer.layerName = 'PathOffsetLayer'\r\nPathOffsetLayer.defaultProps = {\r\n  getOffset: { type: 'accessor', value: OFFSET_TYPE.RIGHT },\r\n}\r\n\r\n// /** DeckGL **/\r\n// new deck.DeckGL({\r\n//   container: 'container',\r\n//   mapboxApiAccessToken: '',\r\n//   longitude: -122.408,\r\n//   latitude: 37.785,\r\n//   zoom: 16,\r\n//   pitch: 0,\r\n//   layers: [\r\n//     new deck.PathLayer({\r\n//       data:\r\n//         'https://raw.githubusercontent.com/uber-common/deck.gl-data/master/website/bart-lines.json',\r\n//       getPath: d => d.path,\r\n//       getColor: [0, 0, 0],\r\n//       getWidth: 50,\r\n//     }),\r\n//     new MyPathLayer({\r\n//       data:\r\n//         'https://raw.githubusercontent.com/uber-common/deck.gl-data/master/website/bart-lines.json',\r\n//       getPath: d => d.path,\r\n//       getColor: [255, 0, 0],\r\n//       getOffset: (d, { index }) => index % 3,\r\n//       getWidth: 50,\r\n//       pickable: true,\r\n//       autoHighlight: true,\r\n//     }),\r\n//   ],\r\n// })\r\n"],"names":["PathOffsetLayer","PathLayer","initializeState","context","super","this","getAttributeManager","addInstanced","instanceOffset","size","accessor","getShaders","__spreadValues","inject","layerName","defaultProps","getOffset","type","value"],"mappings":"mUAQA,MAAAA,UAA6CC,EAC3CC,gBAAgBC,GACdC,MAAMF,gBAAgBC,GAEtBE,KAAKC,sBAAsBC,aAAa,CACtCC,eAAgB,CACdC,KAAM,EACNC,SAAU,eAKhBC,aACS,4HAAAC,CAAA,GACFR,MAAMO,oBADJ,CAELE,OAAQ,CACN,WAAY,iGAIZ,iBAAkB,uDAGlB,WAAY,oDAGZ,iBAAkB,yUAgB1Bb,EAAgBc,UAAY,kBAC5Bd,EAAgBe,aAAe,CAC7BC,UAAW,CAAEC,KAAM,WAAYC,MA/CxB"}