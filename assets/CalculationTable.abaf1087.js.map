{"version":3,"file":"CalculationTable.abaf1087.js","sources":["../../src/plugins/calculation-table/CalculationTable.vue","../../src/plugins/calculation-table/CalculationTable.vue?vue&type=template&lang.js","../../src/plugins/calculation-table/assets/table.png"],"sourcesContent":["<template lang=\"pug\">\r\n.my-component(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\")\r\n\r\n  img.thumb(v-if=\"thumbnail\" src=\"./assets/table.png\" :width=\"128\")\r\n\r\n\r\n  .topsheet(v-if=\"!thumbnail && isLoaded\")\r\n      p.header {{ subfolder }}\r\n\r\n      h2 {{ vizDetails.title }}\r\n      p {{ vizDetails.description}}\r\n\r\n      hr\r\n\r\n      component.dash-card(\r\n        is=\"TopSheet\"\r\n        :fileSystemConfig=\"fileSystem\"\r\n        :subfolder=\"subfolder\"\r\n        :config=\"vizDetails\"\r\n        :yaml=\"yamlConfig\"\r\n        :files=\"files\"\r\n        :cardTitle=\"vizDetails.title\"\r\n        :cardId=\"'table1'\"\r\n        :allConfigFiles=\"allConfigFiles\"\r\n      )\r\n\r\n      //- @isLoaded=\"handleCardIsLoaded(card)\"\r\n      //- @dimension-resizer=\"setDimensionResizer\"\r\n      //- @titles=\"setCardTitles(card, $event)\"\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport YAML from 'yaml'\r\n\r\nimport util from '@/js/util'\r\nimport globalStore from '@/store'\r\n\r\nimport { ColorScheme, FileSystemConfig, VisualizationPlugin, Status, YamlConfigs } from '@/Globals'\r\n\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport TopSheet from '@/components/TopSheet/TopSheet.vue'\r\n\r\nconst thumbnailUrl = \"url('assets/thumbnail.jpg') no-repeat;\"\r\n\r\nconst Component = defineComponent({\r\n  name: 'CalculationTable',\r\n  components: { TopSheet },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    return {\r\n      globalState: globalStore.state,\r\n      allConfigFiles: { dashboards: {}, topsheets: {}, vizes: {}, configs: {} } as YamlConfigs,\r\n      files: [] as string[],\r\n      isLoaded: false,\r\n      vizDetails: {\r\n        title: '',\r\n        description: '',\r\n        thumbnail: '',\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): any {\r\n      return thumbnailUrl\r\n    },\r\n  },\r\n  methods: {\r\n    async getVizDetails() {\r\n      if (!this.fileApi) return\r\n\r\n      console.log(this.yamlConfig)\r\n      // first get config\r\n      try {\r\n        const text = await this.fileApi.getFileText(this.subfolder + '/' + this.yamlConfig)\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (e) {\r\n        console.error('failed')\r\n      }\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'Table'\r\n      this.$emit('title', t)\r\n    },\r\n  },\r\n  async mounted() {\r\n    await this.getVizDetails()\r\n    this.allConfigFiles = await this.fileApi.findAllYamlConfigs(this.subfolder)\r\n    const { files } = await this.fileApi.getDirectory(this.subfolder)\r\n    this.files = files\r\n\r\n    this.isLoaded = true\r\n\r\n    if (this.thumbnail) return\r\n  },\r\n})\r\n\r\nexport default Component\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.my-component {\r\n  margin: 0 0;\r\n  padding: 0 2rem;\r\n  background-color: var(--bgMapPanel);\r\n}\r\n\r\n.header {\r\n  margin-top: 0.5rem;\r\n  margin-bottom: 2rem;\r\n  color: var(--text);\r\n}\r\n\r\n.topsheet {\r\n  max-width: 55rem;\r\n  margin: 0rem auto;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n}\r\n</style>\r\n","\r\n.my-component(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\")\r\n\r\n  img.thumb(v-if=\"thumbnail\" src=\"./assets/table.png\" :width=\"128\")\r\n\r\n\r\n  .topsheet(v-if=\"!thumbnail && isLoaded\")\r\n      p.header {{ subfolder }}\r\n\r\n      h2 {{ vizDetails.title }}\r\n      p {{ vizDetails.description}}\r\n\r\n      hr\r\n\r\n      component.dash-card(\r\n        is=\"TopSheet\"\r\n        :fileSystemConfig=\"fileSystem\"\r\n        :subfolder=\"subfolder\"\r\n        :config=\"vizDetails\"\r\n        :yaml=\"yamlConfig\"\r\n        :files=\"files\"\r\n        :cardTitle=\"vizDetails.title\"\r\n        :cardId=\"'table1'\"\r\n        :allConfigFiles=\"allConfigFiles\"\r\n      )\r\n\r\n      //- @isLoaded=\"handleCardIsLoaded(card)\"\r\n      //- @dimension-resizer=\"setDimensionResizer\"\r\n      //- @titles=\"setCardTitles(card, $event)\"\r\n\r\n","export default \"__VITE_ASSET__439da6cc__\""],"names":["Component","defineComponent","name","components","TopSheet","props","root","type","String","required","subfolder","yamlConfig","config","Object","thumbnail","Boolean","data","globalState","globalStore","state","allConfigFiles","dashboards","topsheets","vizes","configs","files","isLoaded","vizDetails","title","description","computed","fileApi","HTTPFileSystem","this","fileSystem","svnProject","$store","svnProjects","filter","a","slug","length","console","log","Error","urlThumbnail","methods","getVizDetails","text","getFileText","YAML","parse","e","error","t","$emit","mounted","findAllYamlConfigs","getDirectory","_vm","_h","$createElement","_c","_self","staticClass","class","attrs","oncontextmenu","src","width","_e","_v","_s","tag","fileSystemConfig","yaml","cardTitle","cardId"],"mappings":"4NA4CA,MAEAA,EAAAC,EAAA,CACAC,KAAA,mBACAC,WAAA,CAAAC,SAAAA,GACAC,MAAA,CACAC,KAAA,CAAAC,KAAAC,OAAAC,UAAA,GACAC,UAAA,CAAAH,KAAAC,OAAAC,UAAA,GACAE,WAAAH,OACAI,OAAAC,OACAC,UAAAC,SAEAC,KAAA,KACA,CACAC,YAAAC,EAAAC,MACAC,eAAA,CAAAC,WAAA,GAAAC,UAAA,GAAAC,MAAA,GAAAC,QAAA,IACAC,MAAA,GACAC,UAAA,EACAC,WAAA,CACAC,MAAA,GACAC,YAAA,GACAf,UAAA,MAIAgB,SAAA,CACAC,UACA,OAAA,IAAAC,EAAAC,KAAAC,WAAAhB,IAEAgB,aACA,MAAAC,EAAAF,KAAAG,OAAAjB,MAAAkB,YAAAC,QACAC,GAAAA,EAAAC,OAAAP,KAAA3B,OAEA,GAAA,IAAA6B,EAAAM,OAEA,MADAC,QAAAC,IAAA,mBACAC,MAEA,OAAAT,EAAA,IAGAU,aAAA,IAxCA,0CA4CAC,QAAA,CAAAC,sBAEA,IAAAd,KAAAF,QAAA,OAEAW,QAAAC,IAAAV,KAAAtB,YAEA,IACA,MAAAqC,QAAAf,KAAAF,QAAAkB,YAAAhB,KAAAvB,UAAA,IAAAuB,KAAAtB,YACAsB,KAAAN,WAAAuB,EAAAC,MAAAH,GAAA,MACAI,GACAV,QAAAW,MAAA,UAEA,MAAAC,EAAArB,KAAAN,WAAAC,MAAAK,KAAAN,WAAAC,MAAA,QACAK,KAAAsB,MAAA,QAAAD,KAAAE,sBAIAvB,KAAAc,gBACAd,KAAAb,qBAAAa,KAAAF,QAAA0B,mBAAAxB,KAAAvB,WACA,MAAAe,MAAAA,SAAAQ,KAAAF,QAAA2B,aAAAzB,KAAAvB,WACAuB,KAAAR,MAAAA,EAEAQ,KAAAP,UAAA,EAEAO,KAAAnB,mCC/Ga,WACX,IAAI6C,EAAI1B,KACJ2B,EAAGD,EAAIE,eACPC,EAAGH,EAAII,MAAMD,IAAIF,EAErB,OAAOE,EAAG,MAAO,CACfE,YAAa,eACbC,MAAO,CACL,kBAAmBN,EAAI7C,WAEzBoD,MAAO,CACLC,cAAiB,iBAElB,CAACR,EAAI7C,UAAYgD,EAAG,MAAO,CAC5BE,YAAa,QACbE,MAAO,CACLE,ICjBS,wCDkBTC,MAAS,OAERV,EAAIW,MAAOX,EAAI7C,WAAa6C,EAAIjC,SAAWoC,EAAG,MAAO,CACxDE,YAAa,YACZ,CAACF,EAAG,IAAK,CACVE,YAAa,UACZ,CAACL,EAAIY,GAAGZ,EAAIa,GAAGb,EAAIjD,cAAeoD,EAAG,KAAM,CAACH,EAAIY,GAAGZ,EAAIa,GAAGb,EAAIhC,WAAWC,UAAWkC,EAAG,IAAK,CAACH,EAAIY,GAAGZ,EAAIa,GAAGb,EAAIhC,WAAWE,gBAAiBiC,EAAG,MAAOA,EAAG,WAAY,CACrKW,IAAK,YACLT,YAAa,YACbE,MAAO,CACLQ,iBAAoBf,EAAIzB,WACxBxB,UAAaiD,EAAIjD,UACjBE,OAAU+C,EAAIhC,WACdgD,KAAQhB,EAAIhD,WACZc,MAASkC,EAAIlC,MACbmD,UAAajB,EAAIhC,WAAWC,MAC5BiD,OAAU,SACVzD,eAAkBuC,EAAIvC,mBAErB,GAAKuC,EAAIW,SAGM"}