var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,o=(t,e)=>{for(var n in e||(e={}))r.call(e,n)&&s(t,n,e[n]);if(i)for(var n of i(e))a.call(e,n)&&s(t,n,e[n]);return t},l=(t,i)=>e(t,n(i)),h=(t,e)=>{var n={};for(var s in t)r.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&i)for(var s of i(t))e.indexOf(s)<0&&a.call(t,s)&&(n[s]=t[s]);return n},d=(t,e,n)=>(s(t,"symbol"!=typeof e?e+"":e,n),n);import{m as u,d as c}from"./vendor.e9c367ae.js";import{g as f,C as p,M as g,n as m}from"./index.2deacc07.js";import{a as _,_ as y,b as v,c as b,C as w,X as x,Y as k,M as C,G as A,l as S,O as L}from"./layer.b20bd88e.js";import{S as I,I as z,T as E,C as P}from"./text-layer.f1b6c0de.js";import{T,c as O,a as D,P as M}from"./path-layer.f17fbd6c.js";var B="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";const R={lightSources:{}};function F(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map((t=>t*e/255))}function N(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?F(e):[0,0,0],n.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=F(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=F(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=i.length,r}const U={name:"lights",vs:B,fs:B,getUniforms:function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R;if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},N({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}};var Z="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";const G={};function j(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}function W(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G;if(!("material"in t))return{};const{material:e}=t;return e?j(e):{lighting_uEnabled:!1}}const H={name:"gouraud-lighting",dependencies:[U],vs:Z,defines:{LIGHTING_VERTEX:1},getUniforms:W},V={name:"phong-lighting",dependencies:[U],fs:Z,defines:{LIGHTING_FRAGMENT:1},getUniforms:W},K={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function X(t,e,n={}){return function(t,e={}){return Math.sign(function(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let a=0;for(let s=n,o=i-r;s<i;s+=r)a+=(t[s]-t[o])*(t[s+1]+t[o+1]),o=s;return a/2}(t,e))}(t,n)!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,a=(i-n)/r,s=Math.floor(a/2);for(let o=0;o<s;++o){const e=n+o*r,i=n+(a-1-o)*r;for(let n=0;n<r;++n){const r=t[e+n];t[e+n]=t[i+n],t[i+n]=r}}}(t,n),!0)}var Y={exports:{}};function Q(t,e,n){n=n||2;var i,r,a,s,o,l,h,d=e&&e.length,u=d?e[0]*n:t.length,c=q(t,0,u,n,!0),f=[];if(!c||c.next===c.prev)return f;if(d&&(c=function(t,e,n,i){var r,a,s,o=[];for(r=0,a=e.length;r<a;r++)(s=q(t,e[r]*i,r<a-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),o.push(lt(s));for(o.sort(rt),r=0;r<o.length;r++)n=at(o[r],n);return n}(t,e,c,n)),t.length>80*n){i=a=t[0],r=s=t[1];for(var p=n;p<u;p+=n)(o=t[p])<i&&(i=o),(l=t[p+1])<r&&(r=l),o>a&&(a=o),l>s&&(s=l);h=0!==(h=Math.max(a-i,s-r))?32767/h:0}return $(c,f,n,i,r,h,0),f}function q(t,e,n,i,r){var a,s;if(r===wt(t,e,n,i)>0)for(a=e;a<n;a+=i)s=yt(a,t[a],t[a+1],s);else for(a=n-i;a>=e;a-=i)s=yt(a,t[a],t[a+1],s);return s&&ct(s,s.next)&&(vt(s),s=s.next),s}function J(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!ct(i,i.next)&&0!==ut(i.prev,i,i.next))i=i.next;else{if(vt(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function $(t,e,n,i,r,a,s){if(t){!s&&a&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=ot(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,s,o,l,h=1;do{for(n=t,t=null,a=null,s=0;n;){for(s++,i=n,o=0,e=0;e<h&&(o++,i=i.nextZ);e++);for(l=h;o>0||l>0&&i;)0!==o&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,h*=2}while(s>1)}(r)}(t,i,r,a);for(var o,l,h=t;t.prev!==t.next;)if(o=t.prev,l=t.next,a?et(t,i,r,a):tt(t))e.push(o.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),vt(t),t=l.next,h=l.next;else if((t=l)===h){s?1===s?$(t=nt(J(t),e,n),e,n,i,r,a,2):2===s&&it(t,e,n,i,r,a):$(J(t),e,n,i,r,a,1);break}}}function tt(t){var e=t.prev,n=t,i=t.next;if(ut(e,n,i)>=0)return!1;for(var r=e.x,a=n.x,s=i.x,o=e.y,l=n.y,h=i.y,d=r<a?r<s?r:s:a<s?a:s,u=o<l?o<h?o:h:l<h?l:h,c=r>a?r>s?r:s:a>s?a:s,f=o>l?o>h?o:h:l>h?l:h,p=i.next;p!==e;){if(p.x>=d&&p.x<=c&&p.y>=u&&p.y<=f&&ht(r,o,a,l,s,h,p.x,p.y)&&ut(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function et(t,e,n,i){var r=t.prev,a=t,s=t.next;if(ut(r,a,s)>=0)return!1;for(var o=r.x,l=a.x,h=s.x,d=r.y,u=a.y,c=s.y,f=o<l?o<h?o:h:l<h?l:h,p=d<u?d<c?d:c:u<c?u:c,g=o>l?o>h?o:h:l>h?l:h,m=d>u?d>c?d:c:u>c?u:c,_=ot(f,p,e,n,i),y=ot(g,m,e,n,i),v=t.prevZ,b=t.nextZ;v&&v.z>=_&&b&&b.z<=y;){if(v.x>=f&&v.x<=g&&v.y>=p&&v.y<=m&&v!==r&&v!==s&&ht(o,d,l,u,h,c,v.x,v.y)&&ut(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==s&&ht(o,d,l,u,h,c,b.x,b.y)&&ut(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=_;){if(v.x>=f&&v.x<=g&&v.y>=p&&v.y<=m&&v!==r&&v!==s&&ht(o,d,l,u,h,c,v.x,v.y)&&ut(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==s&&ht(o,d,l,u,h,c,b.x,b.y)&&ut(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function nt(t,e,n){var i=t;do{var r=i.prev,a=i.next.next;!ct(r,a)&&ft(r,i,i.next,a)&&mt(r,a)&&mt(a,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(a.i/n|0),vt(i),vt(i.next),i=t=a),i=i.next}while(i!==t);return J(i)}function it(t,e,n,i,r,a){var s=t;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&dt(s,o)){var l=_t(s,o);return s=J(s,s.next),l=J(l,l.next),$(s,e,n,i,r,a,0),void $(l,e,n,i,r,a,0)}o=o.next}s=s.next}while(s!==t)}function rt(t,e){return t.x-e.x}function at(t,e){var n=function(t,e){var n,i=e,r=t.x,a=t.y,s=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var o=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=r&&o>s&&(s=o,n=i.x<i.next.x?i:i.next,o===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,h=n,d=n.x,u=n.y,c=1/0;i=n;do{r>=i.x&&i.x>=d&&r!==i.x&&ht(a<u?r:s,a,d,u,a<u?s:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),mt(i,t)&&(l<c||l===c&&(i.x>n.x||i.x===n.x&&st(n,i)))&&(n=i,c=l)),i=i.next}while(i!==h);return n}(t,e);if(!n)return e;var i=_t(n,t);return J(i,i.next),J(n,n.next)}function st(t,e){return ut(t.prev,t,e.prev)<0&&ut(e.next,t,t.next)<0}function ot(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function lt(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ht(t,e,n,i,r,a,s,o){return(r-s)*(e-o)>=(t-s)*(a-o)&&(t-s)*(i-o)>=(n-s)*(e-o)&&(n-s)*(a-o)>=(r-s)*(i-o)}function dt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ft(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(mt(t,e)&&mt(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(ut(t.prev,t,e.prev)||ut(t,e.prev,e))||ct(t,e)&&ut(t.prev,t,t.next)>0&&ut(e.prev,e,e.next)>0)}function ut(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ct(t,e){return t.x===e.x&&t.y===e.y}function ft(t,e,n,i){var r=gt(ut(t,e,n)),a=gt(ut(t,e,i)),s=gt(ut(n,i,t)),o=gt(ut(n,i,e));return r!==a&&s!==o||(!(0!==r||!pt(t,n,e))||(!(0!==a||!pt(t,i,e))||(!(0!==s||!pt(n,t,i))||!(0!==o||!pt(n,e,i)))))}function pt(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function gt(t){return t>0?1:t<0?-1:0}function mt(t,e){return ut(t.prev,t,t.next)<0?ut(t,e,t.next)>=0&&ut(t,t.prev,e)>=0:ut(t,e,t.prev)<0||ut(t,t.next,e)<0}function _t(t,e){var n=new bt(t.i,t.x,t.y),i=new bt(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function yt(t,e,n,i){var r=new bt(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function vt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function bt(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wt(t,e,n,i){for(var r=0,a=e,s=n-i;a<n;a+=i)r+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return r}Y.exports=Q,Y.exports.default=Q,Q.deviation=function(t,e,n,i){var r=e&&e.length,a=r?e[0]*n:t.length,s=Math.abs(wt(t,0,a,n));if(r)for(var o=0,l=e.length;o<l;o++){var h=e[o]*n,d=o<l-1?e[o+1]*n:t.length;s-=Math.abs(wt(t,h,d,n))}var u=0;for(o=0;o<i.length;o+=3){var c=i[o]*n,f=i[o+1]*n,p=i[o+2]*n;u+=Math.abs((t[c]-t[p])*(t[f+1]-t[c+1])-(t[c]-t[f])*(t[p+1]-t[c+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},Q.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var s=0;s<e;s++)n.vertices.push(t[r][a][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var xt=Y.exports;const kt=K.CLOCKWISE,Ct=K.COUNTER_CLOCKWISE,At={isClosed:!0};function St(t){return"positions"in t?t.positions:t}function Lt(t){return"holeIndices"in t?t.holeIndices:null}function It(t,e,n,i,r){let a=e;const s=n.length;for(let o=0;o<s;o++)for(let e=0;e<i;e++)t[a++]=n[o][e]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let o=0;o<i;o++)t[a++]=n[0][o]||0;return At.start=e,At.end=a,At.size=i,X(t,r,At),a}function zt(t,e,n,i,r=0,a,s){const o=(a=a||n.length)-r;if(o<=0)return e;let l=e;for(let h=0;h<o;h++)t[l++]=n[r+h];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,r,a))for(let h=0;h<i;h++)t[l++]=n[r+h];return At.start=e,At.end=l,At.size=i,X(t,s,At),l}function Et(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:a}=t;if(a){let t=0;for(let s=0;s<=a.length;s++)t=zt(n,t,r,e,a[s-1],a[s],0===s?kt:Ct),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return zt(n,0,t,e,0,n.length,kt),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[a,s]of t.entries())r=It(n,r,s,e,0===a?kt:Ct),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return It(n,0,t,e,kt),n}class Pt extends T{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super(l(o({},t),{attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}}))}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=Et(t,this.positionSize);return this.opts.resolution?O(St(e),Lt(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?D(St(e),Lt(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(Tt(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return St(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&Tt(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:i}){const{attributes:r,indexStarts:a,typedArrayManager:s}=this;let o=r.indices;if(!o||!t)return;let l=i;const h=function(t,e,n){let i=Lt(t);i&&(i=i.map((t=>t/e)));let r=St(t);if(n){const t=r.length;r=r.slice();const i=[];for(let a=0;a<t;a+=e){i[0]=r[a],i[1]=r[a+1];const t=n(i);r[a]=t[0],r[a+1]=t[1]}}return xt(r,i,e)}(t,this.positionSize,this.opts.preproject);o=s.allocate(o,i+h.length,{copy:!0});for(let d=0;d<h.length;d++)o[l++]=h[d]+n;a[e+1]=i+h.length,r.indices=o}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:i},positionSize:r}=this;if(!i||!t)return;const a=St(t);for(let s=e,o=0;o<n;s++,o++){const t=a[o*r],e=a[o*r+1],n=r>2?a[o*r+2]:0;i[3*s]=t,i[3*s+1]=e,i[3*s+2]=n}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:i}=this,r=this.attributes.vertexValid,a=t&&Lt(t);if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),a)for(let s=0;s<a.length;s++)r[e+a[s]/i-1]=0;r[e+n-1]=0}}function Tt(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}var Ot="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Dt="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(Ot,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),Mt="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(Ot,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");const Bt=[0,0,0,255],Rt={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Bt},getLineColor:{type:"accessor",value:Bt},material:!0},Ft={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Nt extends _{constructor(...t){super(...t),y(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?Dt:Mt,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[v,H,b]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===w.DEFAULT&&(n=w.LNGLAT),this.setState({numInstances:0,polygonTesselator:new Pt({preproject:n===w.LNGLAT&&e.projectFlat.bind(e),fp64:this.use64bitPositions(),IndexType:!t||x(t,k.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),r=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:r},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ft,accessor:"getPolygon",update:this.calculatePositions,noAlloc:r,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:r},elevations:{size:1,transition:Ft,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ft,accessor:"getFillColor",defaultValue:Bt,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ft,accessor:"getLineColor",defaultValue:Bt,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:i,elevationScale:r}=this.props,{topModel:a,sideModel:s,polygonTesselator:h}=this.state,d=l(o({},t),{extruded:Boolean(e),elevationScale:r});s&&(s.setInstanceCount(h.instanceCount-1),s.setUniforms(d),i&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),a&&(a.setVertexCount(h.vertexCount),a.setUniforms(d).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var a;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(a=this.state.models)||void 0===a||a.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state;if(e.instanceCount)return;const i=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,a;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new C(t,l(o({},n),{id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return i&&(a=new C(t,l(o({},this.getShaders("side")),{id:"".concat(e,"-side"),geometry:new A({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1})),a.userData.excludeAttributes={indices:!0}),{models:[a,r].filter(Boolean),topModel:r,sideModel:a}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}function Ut({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:a=1/0}=n,s=t.length;let o=s,l=s;for(let u=0;u<s;u++){const n=e(t[u]);if(o>u&&n>=r&&(o=u),n>=a){l=u;break}}let h=o;const d=l-o!==i.length?t.slice(l):void 0;for(let u=0;u<i.length;u++)t[h++]=i[u];if(d){for(let e=0;e<d.length;e++)t[h++]=d[e];t.length=h}return{startRow:o,endRow:o+i.length}}function Zt(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:o({},t.properties[e])};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}(t,i,n):null}y(Nt,"defaultProps",Rt),y(Nt,"layerName","SolidPolygonLayer");const Gt={circle:{type:I,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:z,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:E,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},jt={type:M,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Wt={type:Nt,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Ht({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function Vt(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const a in e){const s=e[a];let o=t.props[a];a.startsWith("get")&&(o=t.getSubLayerAccessor(o),r.updateTriggers[s]=i[a],n&&(r.transitions[s]=n[a])),r[s]=o}return r}function Kt(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:a=t.length}=n;for(let s=r;s<a;s++){const n=t[s],{geometry:r}=n;if(r)if("GeometryCollection"===r.type){S.assert(Array.isArray(r.geometries),"GeoJSON does not have geometries array");const{geometries:t}=r;for(let r=0;r<t.length;r++){Xt(t[r],i,e,n,s)}}else Xt(r,i,e,n,s)}return i}function Xt(t,e,n,i,r){const{type:a,coordinates:s}=t,{pointFeatures:o,lineFeatures:l,polygonFeatures:h,polygonOutlineFeatures:d}=e;if(function(t,e){let n=Yt[t];S.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(a,s))switch(a){case"Point":o.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach((t=>{o.push(n({geometry:{type:"Point",coordinates:t}},i,r))}));break;case"LineString":l.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"Polygon":h.push(n({geometry:t},i,r)),s.forEach((t=>{d.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"MultiPolygon":s.forEach((t=>{h.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach((t=>{d.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}))}))}else S.warn("".concat(a," coordinates are malformed"))()}const Yt={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Qt(t){return t.geometry.coordinates}function qt(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:a}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const a=[];for(let t=0;t<r.length;t++)e(r[t],a),n[i][3*t+0]=a[0],n[i][3*t+1]=a[1],n[i][3*t+2]=a[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:l(o({},i.attributes),{getPosition:i.positions,instancePickingColors:{size:3,value:s.points}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:l(o({},r.attributes),{getPath:r.positions,instancePickingColors:{size:3,value:s.lines}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:a.polygonIndices.value.length-1,startIndices:a.polygonIndices.value,attributes:l(o({},a.attributes),{getPolygon:a.positions,pickingColors:{size:3,value:s.polygons}}),properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},n.polygons._normalize=!1,a.triangles&&(n.polygons.data.attributes.indices=a.triangles.value),n.polygonsOutline.data={length:a.primitivePolygonIndices.value.length-1,startIndices:a.primitivePolygonIndices.value,attributes:l(o({},a.attributes),{getPath:a.positions,instancePickingColors:{size:3,value:s.polygons}}),properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},n.polygonsOutline._pathType="open",n}const Jt=["points","linestrings","polygons"],$t=l(o(o(o(o(o({},Ht(Gt.circle)),Ht(Gt.icon)),Ht(Gt.text)),Ht(jt)),Ht(Wt)),{stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}});class te extends P{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=qt(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(S.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return S.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),i=this.getSubLayerRow.bind(this);let r={};const a={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)r[e]=t[e].slice(),a[e]=[];for(const s of e.dataChanged){const e=Kt(n,i,s);for(const n in t)a[n].push(Ut({data:r[n],getIndex:t=>t.__source.index,dataRange:s,replace:e[n]}))}}else r=Kt(n,i);const s=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:a,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Qt,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Qt,n.polygons.data=a,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Qt,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Qt,n}(r,a);this.setState({features:r,featuresDiff:a,layerProps:s})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=Jt.find((t=>i.id.startsWith("".concat(this.id,"-").concat(t,"-")))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,Wt.type);if(r){const a=Vt(this,Wt.props),s=t&&e;return s||delete a.getLineColor,a.updateTriggers.lineColors=s,new r(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",a=!t&&e&&this.shouldRenderSubLayer(i,n.polygonsOutline.data)&&this.getSubLayerClass(i,jt.type),s=this.shouldRenderSubLayer(r,n.lines.data)&&this.getSubLayerClass(r,jt.type);if(a||s){const t=Vt(this,jt.props);return[a&&new a(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex((t=>t.__source.index===i)));const r=new Set(t.split("+")),a=[];for(const s of r){const t="points-".concat(s),r=Gt[s],d=r&&this.shouldRenderSubLayer(t,e.points.data)&&this.getSubLayerClass(t,r.type);if(d){const u=Vt(this,r.props);let c=e.points;if("text"===s&&n){const t=c.data.attributes,{instancePickingColors:e}=t,n=h(t,["instancePickingColors"]);c=l(o({},c),{data:l(o({},c.data),{attributes:n})})}a.push(new d(u,this.getSubLayerProps({id:t,updateTriggers:u.updateTriggers,highlightedObjectIndex:i}),c))}}return a}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:i,index:r}=n,a=Zt(i,r);return t(a,n)}:super.getSubLayerAccessor(t)}}y(te,"layerName","GeoJsonLayer"),y(te,"defaultProps",$t);var ee={},ne={geometries:{NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31}},ie={},re={lpad:function(t,e,n){for(;t.length<e;)t=n+t;return t},rpad:function(t,e,n){for(;t.length<e;)t+=n;return t},writeField:function(t,e,n,i){for(var r=0;r<e;r++)t.setUint8(i,n.charCodeAt(r)),i++;return i}},ae={},se={C:254,L:1,D:8,N:18,M:18,F:18,B:8},oe={string:"C",number:"N",boolean:"L",null:"C"};function le(t){var e={},n=[];for(var i in t)e[i]=null===t[i]?"null":typeof t[i];for(var r in e){var a=oe[e[r]];a&&n.push({name:r,type:a,size:se[a]})}return n}ae.multi=function(t){var e={};return t.forEach((function(t){!function(t,e){for(var n in e){var i=void 0!==e[n]&&null!==e[n];(void 0===t[n]||i)&&(t[n]=e[n])}}(e,t)})),le(e)},ae.bytesPer=function(t){return t.reduce((function(t,e){return t+e.size}),1)},ae.obj=le;var he=re,de=ae;ie.structure=function(t,e){var n=e||de.multi(t),i=32*n.length+1,r=de.bytesPer(n),a=new ArrayBuffer(i+32+r*t.length+1),s=new Date,o=new DataView(a);o.setUint8(0,3),o.setUint8(1,s.getFullYear()-1900),o.setUint8(2,s.getMonth()),o.setUint8(3,s.getDate()),o.setUint32(4,t.length,!0);var l=i+32;o.setUint16(8,l,!0),o.setUint16(10,r,!0),o.setInt8(32+i-1,13),n.forEach((function(t,e){t.name.split("").slice(0,8).forEach((function(t,n){o.setInt8(32+32*e+n,t.charCodeAt(0))})),o.setInt8(32+32*e+11,t.type.charCodeAt(0)),o.setInt8(32+32*e+16,t.size),"N"==t.type&&o.setInt8(32+32*e+17,3)}));var h=i+32;return t.forEach((function(t,e){o.setUint8(h,32),h++,n.forEach((function(e){var n=t[e.name];switch(null==n&&(n=""),e.type){case"L":o.setUint8(h,n?84:70),h++;break;case"D":h=he.writeField(o,8,he.lpad(n.toString(),8," "),h);break;case"N":h=he.writeField(o,e.size,he.lpad(n.toString(),e.size," ").substr(0,18),h);break;case"C":h=he.writeField(o,e.size,he.rpad(n.toString(),e.size," "),h);break;default:throw new Error("Unknown field type")}}))})),o.setUint8(h,26),o};var ue={enlarge:function(t,e){return e[0]<t.xmin&&(t.xmin=e[0]),e[0]>t.xmax&&(t.xmax=e[0]),e[1]<t.ymin&&(t.ymin=e[1]),e[1]>t.ymax&&(t.ymax=e[1]),t},enlargeExtent:function(t,e){return e.xmax>t.xmax&&(t.xmax=e.xmax),e.xmin<t.xmin&&(t.xmin=e.xmin),e.ymax>t.ymax&&(t.ymax=e.ymax),e.ymin<t.ymin&&(t.ymin=e.ymin),t},blank:function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}}},ce={},fe=ue;ce.write=function(t,e,n,i){var r=100,a=0,s=0;t.forEach((function(t,e){n.setInt32(a,e),n.setInt32(a+4,10),n.setInt32(a+8,1,!0),n.setFloat64(a+12,t[0],!0),n.setFloat64(a+20,t[1],!0),i.setInt32(s,r/2),i.setInt32(s+4,10),s+=8,a+=28,r+=28}))},ce.extent=function(t){return t.reduce((function(t,e){return fe.enlarge(t,e)}),fe.blank())},ce.parts=function(t,e){return t.length},ce.shxLength=function(t){return 8*t.length},ce.shpLength=function(t){return 28*t.length};var pe={},ge=ue,me=ne;function _e(t,e){var n=1;return e!==me.geometries.POLYGON&&e!==me.geometries.POLYLINE||(n=t.reduce((function(t,e){return t+=e.length,Array.isArray(e[0][0][0])&&(t+=e.reduce((function(t,e){return t+e.length-1}),0)),t}),0)),n}function ye(t,e){return void 0===e&&(e=[]),"object"==typeof t[0][0]?t.reduce((function(t,e){return t.concat(ye(e))}),e):t}pe.write=function(t,e,n,i,r){var a=0,s=0,o=100;t.forEach((function(t,e){var l=ye(t),h=_e([t],r),d=16*l.length+48+4*(h-1),u=l.reduce((function(t,e){return ge.enlarge(t,e)}),ge.blank());i.setInt32(s,o/2),i.setInt32(s+4,d/2),s+=8,o+=d+8,n.setInt32(a,e+1),n.setInt32(a+4,d/2),n.setInt32(a+8,r,!0),n.setFloat64(a+12,u.xmin,!0),n.setFloat64(a+20,u.ymin,!0),n.setFloat64(a+28,u.xmax,!0),n.setFloat64(a+36,u.ymax,!0),n.setInt32(a+44,h,!0),n.setInt32(a+48,l.length,!0),n.setInt32(a+52,0,!0);for(var c=t.reduce((function(t,e){return Array.isArray(e[0][0])?t=t.concat(e):t.push(e),t}),[]),f=1;f<h;f++)n.setInt32(a+52+4*f,c.reduce((function(t,e,n){return n<f?t+e.length:t}),0),!0);l.forEach((function(t,e){n.setFloat64(a+56+16*e+4*(h-1),t[0],!0),n.setFloat64(a+56+16*e+4*(h-1)+8,t[1],!0)})),a+=d+8}))},pe.shpLength=function(t){return 56*t.length+16*ye(t).length},pe.shxLength=function(t){return 8*t.length},pe.extent=function(t){return ye(t).reduce((function(t,e){return ge.enlarge(t,e)}),ge.blank())},pe.parts=_e;var ve=ne,be=ie,we={1:ce,5:pe,3:pe},xe=function(t,e,n,i){var r=ve.geometries[e],a=we[r],s=100+4*(a.parts(n,r)-n.length)+a.shpLength(n),o=100+a.shxLength(n),l=new ArrayBuffer(s),h=new DataView(l),d=new ArrayBuffer(o),u=new DataView(d),c=a.extent(n);ke(h,r),ke(u,r),Ce(c,h),Ce(c,u),a.write(n,c,new DataView(l,100),new DataView(d,100),r),h.setInt32(24,s/2),u.setInt32(24,50+4*n.length);var f=be.structure(t);i(null,{shp:h,shx:u,dbf:f,prj:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]'})};function ke(t,e){t.setInt32(0,9994),t.setInt32(28,1e3,!0),t.setInt32(32,e,!0)}function Ce(t,e){e.setFloat64(36,t.xmin,!0),e.setFloat64(44,t.ymin,!0),e.setFloat64(52,t.xmax,!0),e.setFloat64(60,t.ymax,!0)}var Ae={};function Se(t,e){return function(n){var i,r=n.features.filter((i=t,function(t){return t.geometry.type===i}));return{geometries:"POLYGON"===e||"POLYLINE"===e?[r.map(Le)]:r.map(Le),properties:r.map(Ie),type:e}}}function Le(t){return void 0!==t.geometry.coordinates[0]&&void 0!==t.geometry.coordinates[0][0]&&void 0!==t.geometry.coordinates[0][0][0]?t.geometry.coordinates[0]:t.geometry.coordinates}function Ie(t){return t.properties}Ae.point=Se("Point","POINT"),Ae.line=Se("LineString","POLYLINE"),Ae.polygon=Se("Polygon","POLYGON");var ze={},Ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";ze.encode=function(t,e){for(var n,i,r,a,s,o,l,h="",d=0;d<t.length;)a=(n=t.charCodeAt(d++))>>2,s=(3&n)<<4|(i=t.charCodeAt(d++))>>4,o=(15&i)<<2|(r=t.charCodeAt(d++))>>6,l=63&r,isNaN(i)?o=l=64:isNaN(r)&&(l=64),h=h+Ee.charAt(a)+Ee.charAt(s)+Ee.charAt(o)+Ee.charAt(l);return h},ze.decode=function(t,e){var n,i,r,a,s,o,l="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)n=Ee.indexOf(t.charAt(h++))<<2|(a=Ee.indexOf(t.charAt(h++)))>>4,i=(15&a)<<4|(s=Ee.indexOf(t.charAt(h++)))>>2,r=(3&s)<<6|(o=Ee.indexOf(t.charAt(h++))),l+=String.fromCharCode(n),64!=s&&(l+=String.fromCharCode(i)),64!=o&&(l+=String.fromCharCode(r));return l};var Pe={};if(Pe.base64=!0,Pe.array=!0,Pe.string=!0,Pe.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,Pe.nodebuffer="undefined"!=typeof Buffer,Pe.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)Pe.blob=!1;else{var Te=new ArrayBuffer(0);try{Pe.blob=0===new Blob([Te],{type:"application/zip"}).size}catch(Ta){try{var Oe=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);Oe.append(Te),Pe.blob=0===Oe.getBlob("application/zip").size}catch(Oa){Pe.blob=!1}}}var De={},Me={},Be={},Re={};!function(t){var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}}return t},t.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var a=0;a<i;a++)t[r+a]=e[n+a]},flattenChunks:function(t){var e,n,i,r,a,s;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(s=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)a=t[e],s.set(a,r),r+=a.length;return s}},i={arraySet:function(t,e,n,i,r){for(var a=0;a<i;a++)t[r+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(e)}(Re);var Fe={},Ne={},Ue={},Ze=Re;function Ge(t){for(var e=t.length;--e>=0;)t[e]=0}var je=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],We=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],He=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ke=new Array(576);Ge(Ke);var Xe=new Array(60);Ge(Xe);var Ye=new Array(512);Ge(Ye);var Qe=new Array(256);Ge(Qe);var qe=new Array(29);Ge(qe);var Je,$e,tn,en=new Array(30);function nn(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function rn(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function an(t){return t<256?Ye[t]:Ye[256+(t>>>7)]}function sn(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function on(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,sn(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function ln(t,e,n){on(t,n[2*e],n[2*e+1])}function hn(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function dn(t,e,n){var i,r,a=new Array(16),s=0;for(i=1;i<=15;i++)a[i]=s=s+n[i-1]<<1;for(r=0;r<=e;r++){var o=t[2*r+1];0!==o&&(t[2*r]=hn(a[o]++,o))}}function un(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function cn(t){t.bi_valid>8?sn(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function fn(t,e,n,i){var r=2*e,a=2*n;return t[r]<t[a]||t[r]===t[a]&&i[e]<=i[n]}function pn(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&fn(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!fn(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function gn(t,e,n){var i,r,a,s,o=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],r=t.pending_buf[t.l_buf+o],o++,0===i?ln(t,r,e):(ln(t,(a=Qe[r])+256+1,e),0!==(s=je[a])&&on(t,r-=qe[a],s),ln(t,a=an(--i),n),0!==(s=We[a])&&on(t,i-=en[a],s))}while(o<t.last_lit);ln(t,256,e)}function mn(t,e){var n,i,r,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(t.heap[++t.heap_len]=h=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)a[2*(r=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=s[2*r+1]);for(e.max_code=h,n=t.heap_len>>1;n>=1;n--)pn(t,a,n);r=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],pn(t,a,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,a[2*r]=a[2*n]+a[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,a[2*n+1]=a[2*i+1]=r,t.heap[1]=r++,pn(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,r,a,s,o,l=e.dyn_tree,h=e.max_code,d=e.stat_desc.static_tree,u=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(a=0;a<=15;a++)t.bl_count[a]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(a=l[2*l[2*(i=t.heap[n])+1]+1]+1)>p&&(a=p,g++),l[2*i+1]=a,i>h||(t.bl_count[a]++,s=0,i>=f&&(s=c[i-f]),o=l[2*i],t.opt_len+=o*(a+s),u&&(t.static_len+=o*(d[2*i+1]+s)));if(0!==g){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(a=p;0!==a;a--)for(i=t.bl_count[a];0!==i;)(r=t.heap[--n])>h||(l[2*r+1]!==a&&(t.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),i--)}}(t,e),dn(a,h,t.bl_count)}function _n(t,e,n){var i,r,a=-1,s=e[1],o=0,l=7,h=4;for(0===s&&(l=138,h=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=e[2*(i+1)+1],++o<l&&r===s||(o<h?t.bl_tree[2*r]+=o:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,a=r,0===s?(l=138,h=3):r===s?(l=6,h=3):(l=7,h=4))}function yn(t,e,n){var i,r,a=-1,s=e[1],o=0,l=7,h=4;for(0===s&&(l=138,h=3),i=0;i<=n;i++)if(r=s,s=e[2*(i+1)+1],!(++o<l&&r===s)){if(o<h)do{ln(t,r,t.bl_tree)}while(0!=--o);else 0!==r?(r!==a&&(ln(t,r,t.bl_tree),o--),ln(t,16,t.bl_tree),on(t,o-3,2)):o<=10?(ln(t,17,t.bl_tree),on(t,o-3,3)):(ln(t,18,t.bl_tree),on(t,o-11,7));o=0,a=r,0===s?(l=138,h=3):r===s?(l=6,h=3):(l=7,h=4)}}Ge(en);var vn=!1;function bn(t,e,n,i){on(t,0+(i?1:0),3),function(t,e,n,i){cn(t),i&&(sn(t,n),sn(t,~n)),Ze.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}Ue._tr_init=function(t){vn||(!function(){var t,e,n,i,r,a=new Array(16);for(n=0,i=0;i<28;i++)for(qe[i]=n,t=0;t<1<<je[i];t++)Qe[n++]=i;for(Qe[n-1]=i,r=0,i=0;i<16;i++)for(en[i]=r,t=0;t<1<<We[i];t++)Ye[r++]=i;for(r>>=7;i<30;i++)for(en[i]=r<<7,t=0;t<1<<We[i]-7;t++)Ye[256+r++]=i;for(e=0;e<=15;e++)a[e]=0;for(t=0;t<=143;)Ke[2*t+1]=8,t++,a[8]++;for(;t<=255;)Ke[2*t+1]=9,t++,a[9]++;for(;t<=279;)Ke[2*t+1]=7,t++,a[7]++;for(;t<=287;)Ke[2*t+1]=8,t++,a[8]++;for(dn(Ke,287,a),t=0;t<30;t++)Xe[2*t+1]=5,Xe[2*t]=hn(t,5);Je=new nn(Ke,je,257,286,15),$e=new nn(Xe,We,0,30,15),tn=new nn(new Array(0),He,0,19,7)}(),vn=!0),t.l_desc=new rn(t.dyn_ltree,Je),t.d_desc=new rn(t.dyn_dtree,$e),t.bl_desc=new rn(t.bl_tree,tn),t.bi_buf=0,t.bi_valid=0,un(t)},Ue._tr_stored_block=bn,Ue._tr_flush_block=function(t,e,n,i){var r,a,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),mn(t,t.l_desc),mn(t,t.d_desc),s=function(t){var e;for(_n(t,t.dyn_ltree,t.l_desc.max_code),_n(t,t.dyn_dtree,t.d_desc.max_code),mn(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Ve[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==e?bn(t,e,n,i):4===t.strategy||a===r?(on(t,2+(i?1:0),3),gn(t,Ke,Xe)):(on(t,4+(i?1:0),3),function(t,e,n,i){var r;for(on(t,e-257,5),on(t,n-1,5),on(t,i-4,4),r=0;r<i;r++)on(t,t.bl_tree[2*Ve[r]+1],3);yn(t,t.dyn_ltree,e-1),yn(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),gn(t,t.dyn_ltree,t.dyn_dtree)),un(t),i&&cn(t)},Ue._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(Qe[n]+256+1)]++,t.dyn_dtree[2*an(e)]++),t.last_lit===t.lit_bufsize-1},Ue._tr_align=function(t){on(t,2,3),ln(t,256,Ke),function(t){16===t.bi_valid?(sn(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)};var wn=function(t,e,n,i){for(var r=65535&t|0,a=t>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{a=a+(r=r+e[i++]|0)|0}while(--s);r%=65521,a%=65521}return r|a<<16|0};var xn=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();var kn,Cn=function(t,e,n,i){var r=xn,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^r[255&(t^e[s])];return-1^t},An={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Sn=Re,Ln=Ue,In=wn,zn=Cn,En=An;function Pn(t,e){return t.msg=En[e],e}function Tn(t){return(t<<1)-(t>4?9:0)}function On(t){for(var e=t.length;--e>=0;)t[e]=0}function Dn(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(Sn.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function Mn(t,e){Ln._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Dn(t.strm)}function Bn(t,e){t.pending_buf[t.pending++]=e}function Rn(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function Fn(t,e){var n,i,r=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,h=t.window,d=t.w_mask,u=t.prev,c=t.strstart+258,f=h[a+s-1],p=h[a+s];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(h[(n=e)+s]===p&&h[n+s-1]===f&&h[n]===h[a]&&h[++n]===h[a+1]){a+=2,n++;do{}while(h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&a<c);if(i=258-(c-a),a=c-258,i>s){if(t.match_start=e,s=i,i>=o)break;f=h[a+s-1],p=h[a+s]}}}while((e=u[e&d])>l&&0!=--r);return s<=t.lookahead?s:t.lookahead}function Nn(t){var e,n,i,r,a,s,o,l,h,d,u=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=u+(u-262)){Sn.arraySet(t.window,t.window,u,u,0),t.match_start-=u,t.strstart-=u,t.block_start-=u,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=u?i-u:0}while(--n);e=n=u;do{i=t.prev[--e],t.prev[e]=i>=u?i-u:0}while(--n);r+=u}if(0===t.strm.avail_in)break;if(s=t.strm,o=t.window,l=t.strstart+t.lookahead,h=r,d=void 0,(d=s.avail_in)>h&&(d=h),n=0===d?0:(s.avail_in-=d,Sn.arraySet(o,s.input,s.next_in,d,l),1===s.state.wrap?s.adler=In(s.adler,o,d,l):2===s.state.wrap&&(s.adler=zn(s.adler,o,d,l)),s.next_in+=d,s.total_in+=d,d),t.lookahead+=n,t.lookahead+t.insert>=3)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+3-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function Un(t,e){for(var n,i;;){if(t.lookahead<262){if(Nn(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=Fn(t,n)),t.match_length>=3)if(i=Ln._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=Ln._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Mn(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(Mn(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Mn(t,!1),0===t.strm.avail_out)?1:2}function Zn(t,e){for(var n,i,r;;){if(t.lookahead<262){if(Nn(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=Fn(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Ln._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(Mn(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=Ln._tr_tally(t,0,t.window[t.strstart-1]))&&Mn(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Ln._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(Mn(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Mn(t,!1),0===t.strm.avail_out)?1:2}function Gn(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function jn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Sn.Buf16(1146),this.dyn_dtree=new Sn.Buf16(122),this.bl_tree=new Sn.Buf16(78),On(this.dyn_ltree),On(this.dyn_dtree),On(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Sn.Buf16(16),this.heap=new Sn.Buf16(573),On(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Sn.Buf16(573),On(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Wn(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,Ln._tr_init(e),0):Pn(t,-2)}function Hn(t){var e,n=Wn(t);return 0===n&&((e=t.state).window_size=2*e.w_size,On(e.head),e.max_lazy_match=kn[e.level].max_lazy,e.good_match=kn[e.level].good_length,e.nice_match=kn[e.level].nice_length,e.max_chain_length=kn[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function Vn(t,e,n,i,r,a){if(!t)return-2;var s=1;if(-1===e&&(e=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||8!==n||i<8||i>15||e<0||e>9||a<0||a>4)return Pn(t,-2);8===i&&(i=9);var o=new jn;return t.state=o,o.strm=t,o.wrap=s,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Sn.Buf8(2*o.w_size),o.head=new Sn.Buf16(o.hash_size),o.prev=new Sn.Buf16(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Sn.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=e,o.strategy=a,o.method=n,Hn(t)}kn=[new Gn(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Nn(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,Mn(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(Mn(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Mn(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(Mn(t,!1),t.strm.avail_out),1)})),new Gn(4,4,8,4,Un),new Gn(4,5,16,8,Un),new Gn(4,6,32,32,Un),new Gn(4,4,16,16,Zn),new Gn(8,16,32,32,Zn),new Gn(8,16,128,128,Zn),new Gn(8,32,128,256,Zn),new Gn(32,128,258,1024,Zn),new Gn(32,258,258,4096,Zn)],Ne.deflateInit=function(t,e){return Vn(t,e,8,15,8,0)},Ne.deflateInit2=Vn,Ne.deflateReset=Hn,Ne.deflateResetKeep=Wn,Ne.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},Ne.deflate=function(t,e){var n,i,r,a;if(!t||!t.state||e>5||e<0)return t?Pn(t,-2):-2;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&4!==e)return Pn(t,0===t.avail_out?-5:-2);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,Bn(i,31),Bn(i,139),Bn(i,8),i.gzhead?(Bn(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Bn(i,255&i.gzhead.time),Bn(i,i.gzhead.time>>8&255),Bn(i,i.gzhead.time>>16&255),Bn(i,i.gzhead.time>>24&255),Bn(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),Bn(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Bn(i,255&i.gzhead.extra.length),Bn(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=zn(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(Bn(i,0),Bn(i,0),Bn(i,0),Bn(i,0),Bn(i,0),Bn(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),Bn(i,3),i.status=113);else{var s=8+(i.w_bits-8<<4)<<8;s|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(s|=32),s+=31-s%31,i.status=113,Rn(i,s),0!==i.strstart&&(Rn(i,t.adler>>>16),Rn(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),Dn(t),r=i.pending,i.pending!==i.pending_buf_size));)Bn(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),Dn(t),r=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Bn(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),0===a&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),Dn(t),r=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Bn(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>r&&(t.adler=zn(t.adler,i.pending_buf,i.pending-r,r)),0===a&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Dn(t),i.pending+2<=i.pending_buf_size&&(Bn(i,255&t.adler),Bn(i,t.adler>>8&255),t.adler=0,i.status=113)):i.status=113),0!==i.pending){if(Dn(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&Tn(e)<=Tn(n)&&4!==e)return Pn(t,-5);if(666===i.status&&0!==t.avail_in)return Pn(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var o=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(Nn(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=Ln._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(Mn(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Mn(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Mn(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,i,r,a,s=t.window;;){if(t.lookahead<=258){if(Nn(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=s[r=t.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r]){a=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);t.match_length=258-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=Ln._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Ln._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(Mn(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Mn(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Mn(t,!1),0===t.strm.avail_out)?1:2}(i,e):kn[i.level].func(i,e);if(3!==o&&4!==o||(i.status=666),1===o||3===o)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===o&&(1===e?Ln._tr_align(i):5!==e&&(Ln._tr_stored_block(i,0,0,!1),3===e&&(On(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Dn(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(Bn(i,255&t.adler),Bn(i,t.adler>>8&255),Bn(i,t.adler>>16&255),Bn(i,t.adler>>24&255),Bn(i,255&t.total_in),Bn(i,t.total_in>>8&255),Bn(i,t.total_in>>16&255),Bn(i,t.total_in>>24&255)):(Rn(i,t.adler>>>16),Rn(i,65535&t.adler)),Dn(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},Ne.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?Pn(t,-2):(t.state=null,113===e?Pn(t,-3):0):-2},Ne.deflateSetDictionary=function(t,e){var n,i,r,a,s,o,l,h,d=e.length;if(!t||!t.state)return-2;if(2===(a=(n=t.state).wrap)||1===a&&42!==n.status||n.lookahead)return-2;for(1===a&&(t.adler=In(t.adler,e,d,0)),n.wrap=0,d>=n.w_size&&(0===a&&(On(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new Sn.Buf8(n.w_size),Sn.arraySet(h,e,d-n.w_size,n.w_size,0),e=h,d=n.w_size),s=t.avail_in,o=t.next_in,l=t.input,t.avail_in=d,t.next_in=0,t.input=e,Nn(n);n.lookahead>=3;){i=n.strstart,r=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=2,Nn(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=l,t.avail_in=s,n.wrap=a,0},Ne.deflateInfo="pako deflate (from Nodeca project)";var Kn={},Xn=Re,Yn=!0,Qn=!0;try{String.fromCharCode.apply(null,[0])}catch(Da){Yn=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Da){Qn=!1}for(var qn=new Xn.Buf8(256),Jn=0;Jn<256;Jn++)qn[Jn]=Jn>=252?6:Jn>=248?5:Jn>=240?4:Jn>=224?3:Jn>=192?2:1;function $n(t,e){if(e<65537&&(t.subarray&&Qn||!t.subarray&&Yn))return String.fromCharCode.apply(null,Xn.shrinkBuf(t,e));for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n}qn[254]=qn[254]=1,Kn.string2buf=function(t){var e,n,i,r,a,s=t.length,o=0;for(r=0;r<s;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Xn.Buf8(o),a=0,r=0;a<o;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},Kn.buf2binstring=function(t){return $n(t,t.length)},Kn.binstring2buf=function(t){for(var e=new Xn.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},Kn.buf2string=function(t,e){var n,i,r,a,s=e||t.length,o=new Array(2*s);for(i=0,n=0;n<s;)if((r=t[n++])<128)o[i++]=r;else if((a=qn[r])>4)o[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<s;)r=r<<6|63&t[n++],a--;a>1?o[i++]=65533:r<65536?o[i++]=r:(r-=65536,o[i++]=55296|r>>10&1023,o[i++]=56320|1023&r)}return $n(o,i)},Kn.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+qn[t[n]]>e?n:e};var ti=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},ei=Ne,ni=Re,ii=Kn,ri=An,ai=ti,si=Object.prototype.toString;function oi(t){if(!(this instanceof oi))return new oi(t);this.options=ni.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ai,this.strm.avail_out=0;var n=ei.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(ri[n]);if(e.header&&ei.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(i="string"==typeof e.dictionary?ii.string2buf(e.dictionary):"[object ArrayBuffer]"===si.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=ei.deflateSetDictionary(this.strm,i)))throw new Error(ri[n]);this._dict_set=!0}}function li(t,e){var n=new oi(e);if(n.push(t,!0),n.err)throw n.msg;return n.result}oi.prototype.push=function(t,e){var n,i,r=this.strm,a=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?r.input=ii.string2buf(t):"[object ArrayBuffer]"===si.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new ni.Buf8(a),r.next_out=0,r.avail_out=a),1!==(n=ei.deflate(r,i))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==r.avail_out&&(0!==r.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(ii.buf2binstring(ni.shrinkBuf(r.output,r.next_out))):this.onData(ni.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||0===r.avail_out)&&1!==n);return 4===i?(n=ei.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==i||(this.onEnd(0),r.avail_out=0,!0)},oi.prototype.onData=function(t){this.chunks.push(t)},oi.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ni.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},Fe.Deflate=oi,Fe.deflate=li,Fe.deflateRaw=function(t,e){return(e=e||{}).raw=!0,li(t,e)},Fe.gzip=function(t,e){return(e=e||{}).gzip=!0,li(t,e)};var hi={},di={},ui=Re,ci=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],fi=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],pi=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],gi=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],mi=Re,_i=wn,yi=Cn,vi=function(t,e){var n,i,r,a,s,o,l,h,d,u,c,f,p,g,m,_,y,v,b,w,x,k,C,A,S;n=t.state,i=t.next_in,A=t.input,r=i+(t.avail_in-5),a=t.next_out,S=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),l=n.dmax,h=n.wsize,d=n.whave,u=n.wnext,c=n.window,f=n.hold,p=n.bits,g=n.lencode,m=n.distcode,_=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{p<15&&(f+=A[i++]<<p,p+=8,f+=A[i++]<<p,p+=8),v=g[f&_];e:for(;;){if(f>>>=b=v>>>24,p-=b,0===(b=v>>>16&255))S[a++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=g[(65535&v)+(f&(1<<b)-1)];continue e}if(32&b){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}w=65535&v,(b&=15)&&(p<b&&(f+=A[i++]<<p,p+=8),w+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=A[i++]<<p,p+=8,f+=A[i++]<<p,p+=8),v=m[f&y];n:for(;;){if(f>>>=b=v>>>24,p-=b,!(16&(b=v>>>16&255))){if(0==(64&b)){v=m[(65535&v)+(f&(1<<b)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(x=65535&v,p<(b&=15)&&(f+=A[i++]<<p,(p+=8)<b&&(f+=A[i++]<<p,p+=8)),(x+=f&(1<<b)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=b,p-=b,x>(b=a-s)){if((b=x-b)>d&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(k=0,C=c,0===u){if(k+=h-b,b<w){w-=b;do{S[a++]=c[k++]}while(--b);k=a-x,C=S}}else if(u<b){if(k+=h+u-b,(b-=u)<w){w-=b;do{S[a++]=c[k++]}while(--b);if(k=0,u<w){w-=b=u;do{S[a++]=c[k++]}while(--b);k=a-x,C=S}}}else if(k+=u-b,b<w){w-=b;do{S[a++]=c[k++]}while(--b);k=a-x,C=S}for(;w>2;)S[a++]=C[k++],S[a++]=C[k++],S[a++]=C[k++],w-=3;w&&(S[a++]=C[k++],w>1&&(S[a++]=C[k++]))}else{k=a-x;do{S[a++]=S[k++],S[a++]=S[k++],S[a++]=S[k++],w-=3}while(w>2);w&&(S[a++]=S[k++],w>1&&(S[a++]=S[k++]))}break}}break}}while(i<r&&a<o);i-=w=p>>3,f&=(1<<(p-=w<<3))-1,t.next_in=i,t.next_out=a,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p},bi=function(t,e,n,i,r,a,s,o){var l,h,d,u,c,f,p,g,m,_=o.bits,y=0,v=0,b=0,w=0,x=0,k=0,C=0,A=0,S=0,L=0,I=null,z=0,E=new ui.Buf16(16),P=new ui.Buf16(16),T=null,O=0;for(y=0;y<=15;y++)E[y]=0;for(v=0;v<i;v++)E[e[n+v]]++;for(x=_,w=15;w>=1&&0===E[w];w--);if(x>w&&(x=w),0===w)return r[a++]=20971520,r[a++]=20971520,o.bits=1,0;for(b=1;b<w&&0===E[b];b++);for(x<b&&(x=b),A=1,y=1;y<=15;y++)if(A<<=1,(A-=E[y])<0)return-1;if(A>0&&(0===t||1!==w))return-1;for(P[1]=0,y=1;y<15;y++)P[y+1]=P[y]+E[y];for(v=0;v<i;v++)0!==e[n+v]&&(s[P[e[n+v]]++]=v);if(0===t?(I=T=s,f=19):1===t?(I=ci,z-=257,T=fi,O-=257,f=256):(I=pi,T=gi,f=-1),L=0,v=0,y=b,c=a,k=x,C=0,d=-1,u=(S=1<<x)-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){p=y-C,s[v]<f?(g=0,m=s[v]):s[v]>f?(g=T[O+s[v]],m=I[z+s[v]]):(g=96,m=0),l=1<<y-C,b=h=1<<k;do{r[c+(L>>C)+(h-=l)]=p<<24|g<<16|m|0}while(0!==h);for(l=1<<y-1;L&l;)l>>=1;if(0!==l?(L&=l-1,L+=l):L=0,v++,0==--E[y]){if(y===w)break;y=e[n+s[v]]}if(y>x&&(L&u)!==d){for(0===C&&(C=x),c+=b,A=1<<(k=y-C);k+C<w&&!((A-=E[k+C])<=0);)k++,A<<=1;if(S+=1<<k,1===t&&S>852||2===t&&S>592)return 1;r[d=L&u]=x<<24|k<<16|c-a|0}}return 0!==L&&(r[c+L]=y-C<<24|64<<16|0),o.bits=x,0};function wi(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function xi(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new mi.Buf16(320),this.work=new mi.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ki(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new mi.Buf32(852),e.distcode=e.distdyn=new mi.Buf32(592),e.sane=1,e.back=-1,0):-2}function Ci(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,ki(t)):-2}function Ai(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,Ci(t))):-2}function Si(t,e){var n,i;return t?(i=new xi,t.state=i,i.window=null,0!==(n=Ai(t,e))&&(t.state=null),n):-2}var Li,Ii,zi=!0;function Ei(t){if(zi){var e;for(Li=new mi.Buf32(512),Ii=new mi.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(bi(1,t.lens,0,288,Li,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;bi(2,t.lens,0,32,Ii,0,t.work,{bits:5}),zi=!1}t.lencode=Li,t.lenbits=9,t.distcode=Ii,t.distbits=5}function Pi(t,e,n,i){var r,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new mi.Buf8(a.wsize)),i>=a.wsize?(mi.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>i&&(r=i),mi.arraySet(a.window,e,n-i,r,a.wnext),(i-=r)?(mi.arraySet(a.window,e,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}di.inflateReset=Ci,di.inflateReset2=Ai,di.inflateResetKeep=ki,di.inflateInit=function(t){return Si(t,15)},di.inflateInit2=Si,di.inflate=function(t,e){var n,i,r,a,s,o,l,h,d,u,c,f,p,g,m,_,y,v,b,w,x,k,C,A,S=0,L=new mi.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(n=t.state).mode&&(n.mode=13),s=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,i=t.input,o=t.avail_in,h=n.hold,d=n.bits,u=o,c=l,k=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;d<16;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(2&n.wrap&&35615===h){n.check=0,L[0]=255&h,L[1]=h>>>8&255,n.check=yi(n.check,L,2,0),h=0,d=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&h)){t.msg="unknown compression method",n.mode=30;break}if(d-=4,x=8+(15&(h>>>=4)),0===n.wbits)n.wbits=x;else if(x>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<x,t.adler=n.check=1,n.mode=512&h?10:12,h=0,d=0;break;case 2:for(;d<16;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(n.flags=h,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&(L[0]=255&h,L[1]=h>>>8&255,n.check=yi(n.check,L,2,0)),h=0,d=0,n.mode=3;case 3:for(;d<32;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.head&&(n.head.time=h),512&n.flags&&(L[0]=255&h,L[1]=h>>>8&255,L[2]=h>>>16&255,L[3]=h>>>24&255,n.check=yi(n.check,L,4,0)),h=0,d=0,n.mode=4;case 4:for(;d<16;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&(L[0]=255&h,L[1]=h>>>8&255,n.check=yi(n.check,L,2,0)),h=0,d=0,n.mode=5;case 5:if(1024&n.flags){for(;d<16;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&(L[0]=255&h,L[1]=h>>>8&255,n.check=yi(n.check,L,2,0)),h=0,d=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((f=n.length)>o&&(f=o),f&&(n.head&&(x=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),mi.arraySet(n.head.extra,i,a,f,x)),512&n.flags&&(n.check=yi(n.check,i,f,a)),o-=f,a+=f,n.length-=f),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===o)break t;f=0;do{x=i[a+f++],n.head&&x&&n.length<65536&&(n.head.name+=String.fromCharCode(x))}while(x&&f<o);if(512&n.flags&&(n.check=yi(n.check,i,f,a)),o-=f,a+=f,x)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===o)break t;f=0;do{x=i[a+f++],n.head&&x&&n.length<65536&&(n.head.comment+=String.fromCharCode(x))}while(x&&f<o);if(512&n.flags&&(n.check=yi(n.check,i,f,a)),o-=f,a+=f,x)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;d<16;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(h!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}h=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;d<32;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}t.adler=n.check=wi(h),h=0,d=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=h,n.bits=d,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){h>>>=7&d,d-=7&d,n.mode=27;break}for(;d<3;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}switch(n.last=1&h,d-=1,3&(h>>>=1)){case 0:n.mode=14;break;case 1:if(Ei(n),n.mode=20,6===e){h>>>=2,d-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}h>>>=2,d-=2;break;case 14:for(h>>>=7&d,d-=7&d;d<32;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&h,h=0,d=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(f=n.length){if(f>o&&(f=o),f>l&&(f=l),0===f)break t;mi.arraySet(r,i,a,f,s),o-=f,a+=f,l-=f,s+=f,n.length-=f;break}n.mode=12;break;case 17:for(;d<14;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(n.nlen=257+(31&h),h>>>=5,d-=5,n.ndist=1+(31&h),h>>>=5,d-=5,n.ncode=4+(15&h),h>>>=4,d-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;d<3;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.lens[I[n.have++]]=7&h,h>>>=3,d-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},k=bi(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,k){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(S=n.lencode[h&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=d);){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(y<16)h>>>=m,d-=m,n.lens[n.have++]=y;else{if(16===y){for(A=m+2;d<A;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(h>>>=m,d-=m,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}x=n.lens[n.have-1],f=3+(3&h),h>>>=2,d-=2}else if(17===y){for(A=m+3;d<A;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}d-=m,x=0,f=3+(7&(h>>>=m)),h>>>=3,d-=3}else{for(A=m+7;d<A;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}d-=m,x=0,f=11+(127&(h>>>=m)),h>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;f--;)n.lens[n.have++]=x}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,C={bits:n.lenbits},k=bi(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,k){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},k=bi(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,k){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(o>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=h,n.bits=d,vi(t,c),s=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,i=t.input,o=t.avail_in,h=n.hold,d=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(S=n.lencode[h&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=d);){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(_&&0==(240&_)){for(v=m,b=_,w=y;_=(S=n.lencode[w+((h&(1<<v+b)-1)>>v)])>>>16&255,y=65535&S,!(v+(m=S>>>24)<=d);){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}h>>>=v,d-=v,n.back+=v}if(h>>>=m,d-=m,n.back+=m,n.length=y,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(A=n.extra;d<A;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(S=n.distcode[h&(1<<n.distbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=d);){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(0==(240&_)){for(v=m,b=_,w=y;_=(S=n.distcode[w+((h&(1<<v+b)-1)>>v)])>>>16&255,y=65535&S,!(v+(m=S>>>24)<=d);){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}h>>>=v,d-=v,n.back+=v}if(h>>>=m,d-=m,n.back+=m,64&_){t.msg="invalid distance code",n.mode=30;break}n.offset=y,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(A=n.extra;d<A;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break t;if(f=c-l,n.offset>f){if((f=n.offset-f)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=r,p=s-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{r[s++]=g[p++]}while(--f);0===n.length&&(n.mode=21);break;case 26:if(0===l)break t;r[s++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;d<32;){if(0===o)break t;o--,h|=i[a++]<<d,d+=8}if(c-=l,t.total_out+=c,n.total+=c,c&&(t.adler=n.check=n.flags?yi(n.check,r,c,s-c):_i(n.check,r,c,s-c)),c=l,(n.flags?h:wi(h))!==n.check){t.msg="incorrect data check",n.mode=30;break}h=0,d=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;d<32;){if(0===o)break t;o--,h+=i[a++]<<d,d+=8}if(h!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}h=0,d=0}n.mode=29;case 29:k=1;break t;case 30:k=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=h,n.bits=d,(n.wsize||c!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&Pi(t,t.output,t.next_out,c-t.avail_out),u-=t.avail_in,c-=t.avail_out,t.total_in+=u,t.total_out+=c,n.total+=c,n.wrap&&c&&(t.adler=n.check=n.flags?yi(n.check,r,c,t.next_out-c):_i(n.check,r,c,t.next_out-c)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===u&&0===c||4===e)&&0===k&&(k=-5),k},di.inflateEnd=function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},di.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?-2:(n.head=e,e.done=!1,0):-2},di.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?-2:11===n.mode&&_i(1,e,i,0)!==n.check?-3:Pi(t,e,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},di.inflateInfo="pako inflate (from Nodeca project)";var Ti={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Oi=di,Di=Re,Mi=Kn,Bi=Ti,Ri=An,Fi=ti,Ni=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Ui=Object.prototype.toString;function Zi(t){if(!(this instanceof Zi))return new Zi(t);this.options=Di.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fi,this.strm.avail_out=0;var n=Oi.inflateInit2(this.strm,e.windowBits);if(n!==Bi.Z_OK)throw new Error(Ri[n]);this.header=new Ni,Oi.inflateGetHeader(this.strm,this.header)}function Gi(t,e){var n=new Zi(e);if(n.push(t,!0),n.err)throw n.msg;return n.result}Zi.prototype.push=function(t,e){var n,i,r,a,s,o,l=this.strm,h=this.options.chunkSize,d=this.options.dictionary,u=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?Bi.Z_FINISH:Bi.Z_NO_FLUSH,"string"==typeof t?l.input=Mi.binstring2buf(t):"[object ArrayBuffer]"===Ui.call(t)?l.input=new Uint8Array(t):l.input=t,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new Di.Buf8(h),l.next_out=0,l.avail_out=h),(n=Oi.inflate(l,Bi.Z_NO_FLUSH))===Bi.Z_NEED_DICT&&d&&(o="string"==typeof d?Mi.string2buf(d):"[object ArrayBuffer]"===Ui.call(d)?new Uint8Array(d):d,n=Oi.inflateSetDictionary(this.strm,o)),n===Bi.Z_BUF_ERROR&&!0===u&&(n=Bi.Z_OK,u=!1),n!==Bi.Z_STREAM_END&&n!==Bi.Z_OK)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&n!==Bi.Z_STREAM_END&&(0!==l.avail_in||i!==Bi.Z_FINISH&&i!==Bi.Z_SYNC_FLUSH)||("string"===this.options.to?(r=Mi.utf8border(l.output,l.next_out),a=l.next_out-r,s=Mi.buf2string(l.output,r),l.next_out=a,l.avail_out=h-a,a&&Di.arraySet(l.output,l.output,r,a,0),this.onData(s)):this.onData(Di.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(u=!0)}while((l.avail_in>0||0===l.avail_out)&&n!==Bi.Z_STREAM_END);return n===Bi.Z_STREAM_END&&(i=Bi.Z_FINISH),i===Bi.Z_FINISH?(n=Oi.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Bi.Z_OK):i!==Bi.Z_SYNC_FLUSH||(this.onEnd(Bi.Z_OK),l.avail_out=0,!0)},Zi.prototype.onData=function(t){this.chunks.push(t)},Zi.prototype.onEnd=function(t){t===Bi.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Di.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},hi.Inflate=Zi,hi.inflate=Gi,hi.inflateRaw=function(t,e){return(e=e||{}).raw=!0,Gi(t,e)},hi.ungzip=Gi;var ji={};(0,Re.assign)(ji,Fe,hi,Ti);var Wi="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,Hi=ji;Be.uncompressInputType=Wi?"uint8array":"array",Be.compressInputType=Wi?"uint8array":"array",Be.magic="\b\0",Be.compress=function(t,e){return Hi.deflateRaw(t,{level:e.level||-1})},Be.uncompress=function(t){return Hi.inflateRaw(t)},Me.STORE={magic:"\0\0",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},Me.DEFLATE=Be;var Vi={exports:{}};Vi.exports=function(t,e){return new Buffer(t,e)},Vi.exports.test=function(t){return Buffer.isBuffer(t)},function(t){var e=Pe,n=Me,i=Vi.exports;function r(t){return t}function a(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}function s(e){var n=65536,r=[],a=e.length,s=t.getTypeOf(e),o=0,l=!0;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,i(0))}}catch(Ta){l=!1}if(!l){for(var h="",d=0;d<e.length;d++)h+=String.fromCharCode(e[d]);return h}for(;o<a&&n>1;)try{"array"===s||"nodebuffer"===s?r.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+n,a)))),o+=n}catch(Ta){n=Math.floor(n/2)}return r.join("")}function o(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}t.string2binary=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n));return e},t.arrayBuffer2Blob=function(e,n){t.checkSupport("blob"),n=n||"application/zip";try{return new Blob([e],{type:n})}catch(Ta){try{var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return i.append(e),i.getBlob(n)}catch(Oa){throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=s;var l={};l.string={string:r,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return l.string.uint8array(t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:function(t){return a(t,i(t.length))}},l.array={string:s,array:r,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return i(t)}},l.arraybuffer={string:function(t){return s(new Uint8Array(t))},array:function(t){return o(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:r,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return i(new Uint8Array(t))}},l.uint8array={string:s,array:function(t){return o(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:r,nodebuffer:function(t){return i(t)}},l.nodebuffer={string:s,array:function(t){return o(t,new Array(t.length))},arraybuffer:function(t){return l.nodebuffer.uint8array(t).buffer},uint8array:function(t){return o(t,new Uint8Array(t.length))},nodebuffer:r},t.transformTo=function(e,n){if(n||(n=""),!e)return n;t.checkSupport(e);var i=t.getTypeOf(n);return l[i][e](n)},t.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":e.nodebuffer&&i.test(t)?"nodebuffer":e.uint8array&&t instanceof Uint8Array?"uint8array":e.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(t){if(!e[t.toLowerCase()])throw new Error(t+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(t){var e,n,i="";for(n=0;n<(t||"").length;n++)i+="\\x"+((e=t.charCodeAt(n))<16?"0":"")+e.toString(16).toUpperCase();return i},t.findCompression=function(t){for(var e in n)if(n.hasOwnProperty(e)&&n[e].magic===t)return n[e];return null},t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}}(De);var Ki=De,Xi=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],Yi={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},Qi={};function qi(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}Qi.base64=!1,Qi.binary=!1,Qi.dir=!1,Qi.createFolders=!1,Qi.date=null,Qi.compression=null,Qi.compressionOptions=null,Qi.comment=null,Qi.unixPermissions=null,Qi.dosPermissions=null,qi.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};for(var Ji=qi,$i={},tr=De,er=Pe,nr=Vi.exports,ir=new Array(256),rr=0;rr<256;rr++)ir[rr]=rr>=252?6:rr>=248?5:rr>=240?4:rr>=224?3:rr>=192?2:1;ir[254]=ir[254]=1;var ar=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+ir[t[n]]>e?n:e},sr=function(t){var e,n,i,r,a=t.length,s=new Array(2*a);for(n=0,e=0;e<a;)if((i=t[e++])<128)s[n++]=i;else if((r=ir[i])>4)s[n++]=65533,e+=r-1;else{for(i&=2===r?31:3===r?15:7;r>1&&e<a;)i=i<<6|63&t[e++],r--;r>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return s.length!==n&&(s.subarray?s=s.subarray(0,n):s.length=n),tr.applyFromCharCode(s)};$i.utf8encode=function(t){return er.nodebuffer?nr(t,"utf-8"):function(t){var e,n,i,r,a,s=t.length,o=0;for(r=0;r<s;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=er.uint8array?new Uint8Array(o):new Array(o),a=0,r=0;a<o;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e}(t)},$i.utf8decode=function(t){if(er.nodebuffer)return tr.transformTo("nodebuffer",t).toString("utf-8");for(var e=[],n=0,i=(t=tr.transformTo(er.uint8array?"uint8array":"array",t)).length;n<i;){var r=ar(t,Math.min(n+65536,i));er.uint8array?e.push(sr(t.subarray(n,r))):e.push(sr(t.slice(n,r))),n=r}return e.join("")};var or=De,lr=function(){this.data=[]};lr.prototype={append:function(t){t=or.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}};var hr=lr,dr=De,ur=function(t){this.data=new Uint8Array(t),this.index=0};ur.prototype={append:function(t){0!==t.length&&(t=dr.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}};var cr=ur,fr=Pe,pr=De,gr=function(t,e){if(void 0===t||!t.length)return 0;var n="string"!==Ki.getTypeOf(t);void 0===e&&(e=0);var i=0;e^=-1;for(var r=0,a=t.length;r<a;r++)i=n?t[r]:t.charCodeAt(r),e=e>>>8^Xi[255&(e^i)];return-1^e},mr=Yi,_r=Qi,yr=ze,vr=Me,br=Ji,wr=Vi.exports,xr=$i,kr=hr,Cr=cr,Ar=function(t){if(t._data instanceof br&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===pr.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},Sr=function(t){var e=Ar(t);return"string"===pr.getTypeOf(e)?!t.options.binary&&fr.nodebuffer?wr(e,"utf-8"):t.asBinary():e},Lr=function(t){var e=Ar(this);return null==e?"":(this.options.base64&&(e=yr.decode(e)),e=t&&this.options.binary?Rr.utf8decode(e):pr.transformTo("string",e),t||this.options.binary||(e=pr.transformTo("string",Rr.utf8encode(e))),e)},Ir=function(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}};Ir.prototype={asText:function(){return Lr.call(this,!0)},asBinary:function(){return Lr.call(this,!1)},asNodeBuffer:function(){var t=Sr(this);return pr.transformTo("nodebuffer",t)},asUint8Array:function(){var t=Sr(this);return pr.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var zr=function(t,e){var n,i="";for(n=0;n<e;n++)i+=String.fromCharCode(255&t),t>>>=8;return i},Er=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===n[e]&&(n[e]=arguments[t][e]);return n},Pr=function(t,e,n){var i,r=pr.getTypeOf(e);if("string"==typeof(n=function(t){return!0!==(t=t||{}).base64||null!==t.binary&&void 0!==t.binary||(t.binary=!0),(t=Er(t,_r)).date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t}(n)).unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(t=Or(t)),n.createFolders&&(i=Tr(t))&&Dr.call(this,i,!0),n.dir||null==e)n.base64=!1,n.binary=!1,e=null,r=null;else if("string"===r)n.binary&&!n.base64&&!0!==n.optimizedBinaryString&&(e=pr.string2binary(e));else{if(n.base64=!1,n.binary=!0,!(r||e instanceof br))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===r&&(e=pr.transformTo("uint8array",e))}var a=new Ir(t,e,n);return this.files[t]=a,a},Tr=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},Or=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},Dr=function(t,e){return e=void 0!==e&&e,t=Or(t),this.files[t]||Pr.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},Mr=function(t,e,n){var i,r=new br;return t._data instanceof br?(r.uncompressedSize=t._data.uncompressedSize,r.crc32=t._data.crc32,0===r.uncompressedSize||t.dir?(e=vr.STORE,r.compressedContent="",r.crc32=0):t._data.compressionMethod===e.magic?r.compressedContent=t._data.getCompressedContent():(i=t._data.getContent(),r.compressedContent=e.compress(pr.transformTo(e.compressInputType,i),n))):((i=Sr(t))&&0!==i.length&&!t.dir||(e=vr.STORE,i=""),r.uncompressedSize=i.length,r.crc32=gr(i),r.compressedContent=e.compress(pr.transformTo(e.compressInputType,i),n)),r.compressedSize=r.compressedContent.length,r.compressionMethod=e.magic,r},Br=function(t,e,n,i,r){n.compressedContent;var a,s,o,l,h=pr.transformTo("string",xr.utf8encode(e.name)),d=e.comment||"",u=pr.transformTo("string",xr.utf8encode(d)),c=h.length!==e.name.length,f=u.length!==d.length,p=e.options,g="",m="",_="";o=e._initialMetadata.dir!==e.dir?e.dir:p.dir,l=e._initialMetadata.date!==e.date?e.date:p.date;var y,v,b,w=0,x=0;o&&(w|=16),"UNIX"===r?(x=798,w|=(y=e.unixPermissions,v=o,b=y,y||(b=v?16893:33204),(65535&b)<<16)):(x=20,w|=63&(e.dosPermissions||0)),a=l.getHours(),a<<=6,a|=l.getMinutes(),a<<=5,a|=l.getSeconds()/2,s=l.getFullYear()-1980,s<<=4,s|=l.getMonth()+1,s<<=5,s|=l.getDate(),c&&(m=zr(1,1)+zr(gr(h),4)+h,g+="up"+zr(m.length,2)+m),f&&(_=zr(1,1)+zr(this.crc32(u),4)+u,g+="uc"+zr(_.length,2)+_);var k="";return k+="\n\0",k+=c||f?"\0\b":"\0\0",k+=n.compressionMethod,k+=zr(a,2),k+=zr(s,2),k+=zr(n.crc32,4),k+=zr(n.compressedSize,4),k+=zr(n.uncompressedSize,4),k+=zr(h.length,2),k+=zr(g.length,2),{fileRecord:mr.LOCAL_FILE_HEADER+k+h+g,dirRecord:mr.CENTRAL_FILE_HEADER+zr(x,2)+k+zr(u.length,2)+"\0\0\0\0"+zr(w,4)+zr(i,4)+h+g+u,compressedObject:n}},Rr={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,n,i,r,a=[];for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],r=new Ir(i.name,i._data,Er(i.options)),n=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(n,r)&&a.push(r));return a},file:function(t,e,n){if(1===arguments.length){if(pr.isRegExp(t)){var i=t;return this.filter((function(t,e){return!e.dir&&i.test(t)}))}return this.filter((function(e,n){return!n.dir&&e===t}))[0]||null}return t=this.root+t,Pr.call(this,t,e,n),this},folder:function(t){if(!t)return this;if(pr.isRegExp(t))return this.filter((function(e,n){return n.dir&&t.test(e)}));var e=this.root+t,n=Dr.call(this,e),i=this.clone();return i.root=n.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(t){t=Er(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),pr.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,n,i=[],r=0,a=0,s=pr.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var o in this.files)if(this.files.hasOwnProperty(o)){var l=this.files[o],h=l.options.compression||t.compression.toUpperCase(),d=vr[h];if(!d)throw new Error(h+" is not a valid compression method !");var u=l.options.compressionOptions||t.compressionOptions||{},c=Mr.call(this,l,d,u),f=Br.call(this,o,l,c,r,t.platform);r+=f.fileRecord.length+c.compressedSize,a+=f.dirRecord.length,i.push(f)}var p;p=mr.CENTRAL_DIRECTORY_END+"\0\0\0\0"+zr(i.length,2)+zr(i.length,2)+zr(a,4)+zr(r,4)+zr(s.length,2)+s;var g=t.type.toLowerCase();for(e="uint8array"===g||"arraybuffer"===g||"blob"===g||"nodebuffer"===g?new Cr(r+a+p.length):new kr(r+a+p.length),n=0;n<i.length;n++)e.append(i[n].fileRecord),e.append(i[n].compressedObject.compressedContent);for(n=0;n<i.length;n++)e.append(i[n].dirRecord);e.append(p);var m=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return pr.transformTo(t.type.toLowerCase(),m);case"blob":return pr.arrayBuffer2Blob(pr.transformTo("arraybuffer",m),t.mimeType);case"base64":return t.base64?yr.encode(m):m;default:return m}},crc32:function(t,e){return gr(t,e)},utf8encode:function(t){return pr.transformTo("string",xr.utf8encode(t))},utf8decode:function(t){return xr.utf8decode(t)}},Fr=Rr,Nr=De;function Ur(t){this.data=null,this.length=0,this.index=0}Ur.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return Nr.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}};var Zr=Ur,Gr=Zr,jr=De;function Wr(t,e){this.data=t,e||(this.data=jr.string2binary(this.data)),this.length=this.data.length,this.index=0}Wr.prototype=new Gr,Wr.prototype.byteAt=function(t){return this.data.charCodeAt(t)},Wr.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},Wr.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e};var Hr=Wr,Vr=Zr;function Kr(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}Kr.prototype=new Vr,Kr.prototype.byteAt=function(t){return this.data[t]},Kr.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===e&&this.data[a+1]===n&&this.data[a+2]===i&&this.data[a+3]===r)return a;return-1},Kr.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e};var Xr=Kr,Yr=Xr;function Qr(t){this.data=t,this.length=this.data.length,this.index=0}Qr.prototype=new Yr,Qr.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e};var qr=Qr,Jr=Hr,$r=De,ta=Ji,ea=Fr;function na(t,e){this.options=t,this.loadOptions=e}na.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(t,e,n){return function(){var i=t.index;t.setIndex(e);var r=t.readData(n);return t.setIndex(i),r}},prepareContent:function(t,e,n,i,r){return function(){var t=$r.transformTo(i.uncompressInputType,this.getCompressedContent()),e=i.uncompress(t);if(e.length!==r)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(n),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(e=$r.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+$r.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new ta,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=$r.transformTo("string",this.decompressed.getContent()),ea.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new Jr(this.extraFields[1].value);this.uncompressedSize===$r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===$r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===$r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===$r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,i,r=t.index;for(this.extraFields=this.extraFields||{};t.index<r+this.extraFieldsLength;)e=t.readInt(2),n=t.readInt(2),i=t.readString(n),this.extraFields[e]={id:e,length:n,value:i}},handleUTF8:function(){if(this.useUTF8())this.fileName=ea.utf8decode(this.fileName),this.fileComment=ea.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new Jr(t.value);return 1!==e.readInt(1)||ea.crc32(this.fileName)!==e.readInt(4)?null:ea.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new Jr(t.value);return 1!==e.readInt(1)||ea.crc32(this.fileComment)!==e.readInt(4)?null:ea.utf8decode(e.readString(t.length-5))}return null}};var ia=Hr,ra=qr,aa=Xr,sa=De,oa=Yi,la=na,ha=Pe,da=Fr;function ua(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}ua.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+sa.pretty(e)+", expected "+sa.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=da.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(oa.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===oa.CENTRAL_FILE_HEADER;)(t=new la({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(oa.CENTRAL_DIRECTORY_END);if(-1===t){var e=!0;try{this.reader.setIndex(0),this.checkSignature(oa.LOCAL_FILE_HEADER),e=!1}catch(Ta){}throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(oa.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===sa.MAX_VALUE_16BITS||this.diskWithCentralDirStart===sa.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===sa.MAX_VALUE_16BITS||this.centralDirRecords===sa.MAX_VALUE_16BITS||this.centralDirSize===sa.MAX_VALUE_32BITS||this.centralDirOffset===sa.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(t=this.reader.lastIndexOfSignature(oa.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(oa.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(oa.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=sa.getTypeOf(t);"string"!==e||ha.uint8array?this.reader="nodebuffer"===e?new ra(t):new aa(sa.transformTo("uint8array",t)):this.reader=new ia(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var ca=ze,fa=ua,pa={},ga=De;pa.string2binary=function(t){return ga.string2binary(t)},pa.string2Uint8Array=function(t){return ga.transformTo("uint8array",t)},pa.uint8Array2String=function(t){return ga.transformTo("string",t)},pa.string2Blob=function(t){var e=ga.transformTo("arraybuffer",t);return ga.arrayBuffer2Blob(e)},pa.arrayBuffer2Blob=function(t){return ga.arrayBuffer2Blob(t)},pa.transformTo=function(t,e){return ga.transformTo(t,e)},pa.getTypeOf=function(t){return ga.getTypeOf(t)},pa.checkSupport=function(t){return ga.checkSupport(t)},pa.MAX_VALUE_16BITS=ga.MAX_VALUE_16BITS,pa.MAX_VALUE_32BITS=ga.MAX_VALUE_32BITS,pa.pretty=function(t){return ga.pretty(t)},pa.findCompression=function(t){return ga.findCompression(t)},pa.isRegExp=function(t){return ga.isRegExp(t)};var ma=ze;function _a(t,e){if(!(this instanceof _a))return new _a(t,e);this.files={},this.comment=null,this.root="",t&&this.load(t,e),this.clone=function(){var t=new _a;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}_a.prototype=Fr,_a.prototype.load=function(t,e){var n,i,r,a;for((e=e||{}).base64&&(t=ca.decode(t)),n=(i=new fa(t,e)).files,r=0;r<n.length;r++)a=n[r],this.file(a.fileName,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileComment.length?a.fileComment:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders});return i.zipComment.length&&(this.comment=i.zipComment),this},_a.support=Pe,_a.defaults=Qi,_a.utils=pa,_a.base64={encode:function(t){return ma.encode(t)},decode:function(t){return ma.decode(t)}},_a.compressions=Me;var ya=xe,va=Ae,ba=_a,wa=function(t,e){var n=new ba,i=n.folder(e&&e.folder?e.folder:"layers");[va.point(t),va.line(t),va.polygon(t)].forEach((function(t){t.geometries.length&&t.geometries[0].length&&ya(t.properties,t.type,t.geometries,(function(n,r){var a=e&&e.types[t.type.toLowerCase()]?e.types[t.type.toLowerCase()]:t.type;i.file(a+".shp",r.shp.buffer,{binary:!0}),i.file(a+".shx",r.shx.buffer,{binary:!0}),i.file(a+".dbf",r.dbf.buffer,{binary:!0}),i.file(a+".prj",'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]')}))}));return n.generateAsync({type:"base64"})},xa=wa;ee.download=async function(t,e){var n=await xa(t,e);location.href="data:application/zip;base64,"+n},ee.write=xe,ee.zip=wa;const ka={layers:[],mapStyle:f.getters.mapStyle,controller:!0,screenshotFilename:"",useDevicePixels:!1,getCursor:({isDragging:t,isHovering:e})=>t?"grabbing":e?"pointer":""},Ca={position:"absolute",left:0,top:0,width:"100%",height:"100%"};f.state.colorScheme,p.DarkMode;class Aa extends L{constructor(t={}){t=o(l(o({},ka),{onResize:()=>{this._map&&this._map.resize()},onAfterRender:()=>{this.props.screenshotFilename&&(this.savePNGcallback(),this.props.screenshotFilename="")}}),t);const{mapboxCanvas:e,deckCanvas:n}=function(t){let{container:e=document.body}=t;if("string"==typeof e&&(e=document.querySelector(e)),!e)throw new Error("[DeckMap] container not found");"static"===window.getComputedStyle(e).position&&(e.style.position="relative");const n=document.createElement("div");e.appendChild(n),Object.assign(n.style,Ca);const i=document.createElement("canvas");return i.width=window.innerWidth,i.height=window.innerHeight,i.oncontextmenu=()=>!1,e.appendChild(i),Object.assign(i.style,Ca),{container:e,mapboxCanvas:n,deckCanvas:i}}(t),i=t.viewState,r=t.basemap;super(o({canvas:n},t)),this._map=r||new u.Map({container:e,style:t.mapStyle,interactive:!1,center:[i.longitude,i.latitude],zoom:i.zoom,bearing:i.bearing||0,pitch:i.pitch||0}),this._onBeforeRender=t=>{if(this.onBeforeRender(t),this._map){const t=this.getViewports()[0];this._map.jumpTo({center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),this.redrawMapbox()}}}redrawMapbox(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}setMapStyle(t){this._map&&this._map.setStyle(t)}getMapboxMap(){return this._map}finalize(){this._map&&this._map.remove(),this._map=null,super.finalize()}setProps(t){"onBeforeRender"in t&&this._onBeforeRender&&t.onBeforeRender!==this._onBeforeRender&&(this.onBeforeRender=t.onBeforeRender,t.onBeforeRender=this._onBeforeRender),super.setProps(t)}takeScreenshot(){this.props.useDevicePixels=!0,this.props.screenshotFilename="screenshot1.png",this.redraw()}savePNGcallback(){const t=this._map._canvas.toDataURL("image/png"),e=this.canvas.toDataURL("image/png"),n=this.mergeImageURIs({width:this.canvas.width,height:this.canvas.height,imageDataURLs:[t,e]});this.props.useDevicePixels=!1,n.then((t=>{var e=document.createElement("a");e.setAttribute("href",t),e.setAttribute("download","screenshot.png"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}))}mergeImageURIs(t){return new Promise(((e,n)=>{var i=document.createElement("canvas");i.width=t.width,i.height=t.height,Promise.all(t.imageDataURLs.map((t=>this.add2canvas(i,t)))).then((()=>{const t=i.getContext("2d"),n=i.width-152,r=i.height-8;t.beginPath(),t.rect(n-4,r-14,158,22),t.fillStyle="#ffffff44",t.fill(),t.font="11px Arial",t.fillStyle="#888",t.fillText(" Mapbox   OpenStreetMap",n,r),e(i.toDataURL("image/png"))}))}))}add2canvas(t,e){return new Promise(((n,i)=>{t||i(),e||i();var r=new Image;r.onload=function(){t.getContext("2d").drawImage(this,0,0),n(!0)},r.src=e}))}}class Sa{constructor(){d(this,"layers"),d(this,"deckInstance"),this.layers={},this.deckInstance=null}init(t){if(this.deckInstance=new Aa(l(o({},t),{map:g})),null!==t.mapStyle){const t=f.getters.mapStyle;this.deckInstance.setMapStyle(t)}}destroy(){this.deckInstance&&(this.deckInstance.finalize(),delete this.deckInstance)}hasLayer(t){return!!this.layers[t]}getLayers(){return this.layers}isVisible(t){return this.layers[t]&&!1!==this.layers[t].props.visible}updateDeckInstance(){if(!this.deckInstance)return;const t=[...Object.values(this.layers)];this.deckInstance.setProps({layers:t})}updateStyle(){if(!this.deckInstance)return;const t=f.getters.mapStyle;this.deckInstance.setMapStyle(t)}addLayer(t){if(!t.id)throw new Error(`[layerManager.addLayer] layer id must defined. Received "${t.id}" instead`);this.layers[t.id]=t,this.updateDeckInstance()}updateLayer(t,e){if(!this.layers[t])return;const n=this.layers[t];this.layers[t]=n.clone(e),this.updateDeckInstance()}removeLayer(t){this.hasLayer(t)&&(delete this.layers[t],this.updateDeckInstance())}hideLayer(t){this.hasLayer(t)&&this.updateLayer(t,{visible:!1})}showLayer(t){this.hasLayer(t)&&this.updateLayer(t,{visible:!0})}takeScreenshot(){this.deckInstance.takeScreenshot()}}var La=c({name:"DrawingTool",i18n:{messages:{en:{title:"Draw Shapes",hint:"Click on map to draw shapes.",clear:"Clear",shapefile:"Export","close-shape":"Add more points to close shape.","more-shapes":"Export now or start new shape."},de:{}}},data:()=>{const t=[];return{canExport:!1,hint:"",isDark:f.state.isDarkMode,points:t,showShapeDrawer:!1,layerManager:new Sa,mapID:`map-id-${Math.floor(1e12*Math.random())}`,polygons:[{type:"Feature",geometry:{type:"Polygon",coordinates:[t]},finished:!1}]}},mounted(){console.log("DRATWOOL"),this.hint=this.$t("hint"),this.setupLayerManager(),this.updateLayers()},beforeDestroy(){this.showShapeDrawer=!1,this.layerManager.destroy()},watch:{viewState(){this.layerManager.deckInstance.setProps({viewState:this.viewState})},"globalStore.state.isDarkMode"(){this.isDark=this.$store.state.isDarkMode,this.layerManager.updateStyle()}},computed:{viewState(){return this.$store.state.viewState}},methods:{toggleShapeDrawer(){this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!this.showShapeDrawer},clearShapes(){this.canExport=!1,this.points=[],this.polygons=[{type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1}]},setupLayerManager(){this.layerManager.init({container:`#${this.mapID}`,viewState:this.$store.state.viewState,pickingRadius:3,mapStyle:null,getCursor:({isDragging:t,isHovering:e})=>t?"grabbing":e?"pointer":"crosshair",onViewStateChange:({viewState:t})=>{this.$store.commit("setMapCamera",t)},onClick:this.handleMapClick})},exportIt(){this.polygons=this.polygons.filter((t=>t.finished)),this.points=[],this.updateLayers();const t={type:"FeatureCollection",features:this.polygons};ee.download(t,{folder:"shapefile-wgs84",types:{point:"points",polygon:"polygons",line:"lines"}}),this.startNewPolygon()},cancel(){this.hint=this.$t("hint"),this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!1},handleMapClick(t,e){t.coordinate&&(e.rightButton?this.points.pop():(this.points.push(t.coordinate),this.hint=this.$t("close-shape")),this.updateLayers())},startNewPolygon(){this.points=[],this.polygons.push({type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1})},handlePointClick(t){return 0===t.index&&(this.points.push(this.points[0]),this.polygons[this.polygons.length-1].finished=!0,this.startNewPolygon(),this.canExport=!0,this.hint=this.$t("more-shapes"),this.updateLayers()),!0},handleViewState(t){this.$store.commit("setMapCamera",t)},updateLayers(){const t=this.polygons.slice(0),e=this.points.slice(0);this.layerManager.removeLayer("draw-polygon-layer"),this.layerManager.addLayer(new te({id:"draw-polygon-layer",data:t,pickable:!1,stroked:!0,filled:!0,extruded:!1,lineWidthMinPixels:4,getFillColor:[175,160,255,80],getLineColor:[255,0,200],getLineWidth:10,parameters:{depthTest:!1}})),this.layerManager.removeLayer("draw-scatterplot-layer"),this.layerManager.addLayer(new I({id:"draw-scatterplot-layer",data:e,getPosition:t=>t,pickable:!0,stroked:!0,filled:!0,radiusMinPixels:6,radiusMaxPixels:6,lineWidthMinPixels:2,getFillColor:[255,0,200],getLineColor:[255,255,255],opacity:1,onClick:this.handlePointClick}))}}});const Ia={};var za=m(La,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"draw-thing"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showShapeDrawer,expression:"showShapeDrawer"}],staticClass:"map",attrs:{id:t.mapID},on:{click:t.handleMapClick}}),n("div",{staticClass:"map-actions"},[t.isDark&&t.showShapeDrawer?n("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":t.showShapeDrawer},style:{border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:t.toggleShapeDrawer}},[n("img",{attrs:{src:"/simwrapper/assets/draw-icon-dm.04d4af86.png",width:"16"}})]):t.isDark&&!t.showShapeDrawer?n("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":t.showShapeDrawer},style:{background:"rgb(43,60,78)",border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:t.toggleShapeDrawer}},[n("img",{attrs:{src:"/simwrapper/assets/draw-icon-dm.04d4af86.png",width:"16"}})]):n("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":t.showShapeDrawer},style:{border:"1px solid rgb(224,224,224)"},attrs:{title:"Draw"},on:{click:t.toggleShapeDrawer}},[n("img",{attrs:{src:"data:image/png;base64,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",width:"16"}})])]),t.showShapeDrawer?n("div",{staticClass:"control-panel"},[n("h3",[t._v(t._s(t.$t("title")))]),n("p",[t._v(t._s(t.hint))]),n("div",{staticClass:"buttons"},[n("button",{staticClass:"button is-small export-button",style:{"is-outlined":!t.canExport},attrs:{disabled:!t.canExport},on:{click:t.exportIt}},[t._v(t._s(t.$t("shapefile")))]),n("button",{staticClass:"button is-small is-outlined",on:{click:t.cancel}},[t._v(t._s(t.$t("clear")))])])]):t._e()])}),[],!1,Ea,"42d24d2b",null,null);function Ea(t){for(let e in Ia)this[e]=Ia[e]}var Pa=function(){return za.exports}();export{Pa as D,te as G,K as W,H as g,X as m,V as p};
//# sourceMappingURL=DrawingTool.daac4c85.js.map
